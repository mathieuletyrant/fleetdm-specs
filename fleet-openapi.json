{
  "openapi": "3.1.0",
  "info": {
    "title": "Fleet REST API",
    "version": "1.0.0",
    "description": "REST API for Fleet device management platform",
    "contact": {
      "name": "Fleet",
      "url": "https://fleetdm.com"
    }
  },
  "servers": [
    {
      "url": "{protocol}://{host}",
      "description": "Fleet server",
      "variables": {
        "protocol": {
          "default": "https",
          "enum": [
            "https",
            "http"
          ],
          "description": "Protocol to use"
        },
        "host": {
          "default": "primo.mdm.getprimo.com",
          "description": "Fleet server hostname"
        }
      }
    }
  ],
  "components": {
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "API token authentication. Get your token from My Account > Get API token in the Fleet UI."
      }
    },
    "schemas": {
      "ListActivitiesResponse": {
        "type": "object",
        "properties": {
          "activities": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Activity"
            },
            "description": "Array of activities"
          },
          "meta": {
            "$ref": "#/components/schemas/Meta"
          }
        },
        "required": [
          "activities",
          "meta"
        ],
        "description": "Response for list activities endpoint"
      },
      "Activity": {
        "type": "object",
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the activity was created",
            "example": "2023-07-27T14:35:08Z"
          },
          "id": {
            "type": "integer",
            "description": "Unique identifier for the activity"
          },
          "actor_full_name": {
            "type": "string",
            "description": "Full name of the actor"
          },
          "actor_id": {
            "type": "integer",
            "description": "ID of the actor"
          },
          "actor_gravatar": {
            "type": "string",
            "description": "Gravatar URL of the actor"
          },
          "actor_email": {
            "type": "string",
            "format": "email",
            "description": "Email of the actor"
          },
          "type": {
            "type": "string",
            "description": "Type of activity",
            "example": "installed_software"
          },
          "fleet_initiated": {
            "type": "boolean",
            "description": "Whether the activity was initiated by Fleet"
          },
          "details": {
            "$ref": "#/components/schemas/ActivityDetails"
          }
        },
        "required": [
          "created_at",
          "id",
          "type",
          "fleet_initiated",
          "details"
        ],
        "description": "Represents a single activity in Fleet"
      },
      "ActivityDetails": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "description": "Status of the activity"
          },
          "host_id": {
            "type": "number",
            "description": "ID of the host"
          },
          "host_display_name": {
            "type": "string",
            "description": "Display name of the host"
          },
          "policy_id": {
            "type": [
              "number",
              "null"
            ],
            "description": "ID of the policy"
          },
          "policy_name": {
            "type": [
              "string",
              "null"
            ],
            "description": "Name of the policy"
          },
          "install_uuid": {
            "type": "string",
            "description": "Installation UUID"
          },
          "self_service": {
            "type": "boolean",
            "description": "Whether it was self-service"
          },
          "software_title": {
            "type": "string",
            "description": "Software title"
          },
          "software_package": {
            "type": "string",
            "description": "Software package name"
          },
          "team_id": {
            "type": "number",
            "description": "ID of the team"
          },
          "team_name": {
            "type": "string",
            "description": "Name of the team"
          }
        },
        "additionalProperties": {},
        "description": "Activity detail information varies by activity type"
      },
      "Meta": {
        "type": "object",
        "properties": {
          "has_next_results": {
            "type": "boolean",
            "description": "Whether there are more results available"
          },
          "has_previous_results": {
            "type": "boolean",
            "description": "Whether there are previous results"
          }
        },
        "required": [
          "has_next_results",
          "has_previous_results"
        ],
        "description": "Pagination metadata"
      },
      "CreateFleetMaintainedAppResponse": {
        "type": "object",
        "properties": {
          "software_title_id": {
            "type": "integer",
            "description": "The ID of the created software title",
            "example": 234
          }
        },
        "required": [
          "software_title_id"
        ],
        "description": "Response for create Fleet-maintained app endpoint"
      },
      "CreateFleetMaintainedAppRequest": {
        "type": "object",
        "properties": {
          "fleet_maintained_app_id": {
            "type": "integer",
            "description": "The ID of Fleet-maintained app",
            "example": 3
          },
          "team_id": {
            "type": "integer",
            "description": "The team ID. Adds Fleet-maintained app to the specified team",
            "example": 2
          },
          "install_script": {
            "type": "string",
            "description": "Command that Fleet runs to install software. If not specified Fleet runs default install command for each Fleet-maintained app"
          },
          "pre_install_query": {
            "type": "string",
            "description": "Query that is pre-install condition. If the query doesn't return any result, Fleet won't proceed to install"
          },
          "post_install_script": {
            "type": "string",
            "description": "The contents of the script to run after install. If the specified script fails (exit code non-zero) software install will be marked as failed and rolled back"
          },
          "self_service": {
            "type": "boolean",
            "description": "Self-service software is optional and can be installed by the end user"
          },
          "labels_include_any": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Target hosts that have any label, specified by label name, in the array"
          },
          "labels_exclude_any": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Target hosts that don't have any label, specified by label name, in the array"
          },
          "automatic_install": {
            "type": "boolean",
            "description": "Create a policy that triggers a software install only on hosts missing the software"
          }
        },
        "required": [
          "fleet_maintained_app_id",
          "team_id"
        ],
        "description": "Request body for creating a Fleet-maintained app"
      }
    },
    "parameters": {}
  },
  "paths": {
    "/api/v1/fleet/activities": {
      "get": {
        "summary": "List activities",
        "description": "Returns a list of the activities that have been performed in Fleet.\n\nFor a comprehensive list of activity types and detailed information, please see the [audit logs](https://fleetdm.com/docs/using-fleet/audit-activities) page.",
        "tags": [
          "Activities"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number of the results to fetch",
              "example": 0
            },
            "required": false,
            "description": "Page number of the results to fetch",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page",
              "example": 10
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "What to order results by. Can be any column in the activities table",
              "example": "created_at"
            },
            "required": false,
            "description": "What to order results by. Can be any column in the activities table",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "The direction of the order given the order key. Default is \"asc\"",
              "example": "desc"
            },
            "required": false,
            "description": "The direction of the order given the order key. Default is \"asc\"",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query keywords. Searchable fields include actor_full_name and actor_email"
            },
            "required": false,
            "description": "Search query keywords. Searchable fields include actor_full_name and actor_email",
            "name": "query",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Indicates the activity type to filter by"
            },
            "required": false,
            "description": "Indicates the activity type to filter by",
            "name": "activity_type",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "format": "date-time",
              "description": "Filters to include only activities that happened after this date"
            },
            "required": false,
            "description": "Filters to include only activities that happened after this date",
            "name": "start_created_at",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "format": "date-time",
              "description": "Filters to include only activities that happened before this date. If not specified, set to now"
            },
            "required": false,
            "description": "Filters to include only activities that happened before this date. If not specified, set to now",
            "name": "end_created_at",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved activities",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListActivitiesResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token"
          }
        }
      }
    },
    "/api/v1/fleet/software/fleet_maintained_apps": {
      "post": {
        "summary": "Create Fleet-maintained app",
        "description": "Add Fleet-maintained app so it's available for install.\n\n**Experimental feature.** This feature is undergoing rapid improvement, which may result in breaking changes to the API or configuration surface. It is not recommended for use in automated workflows.\n\n_Available in Fleet Premium._\n\nOnly one of `labels_include_any` or `labels_exclude_any` can be specified. If neither are specified, all hosts are targeted.\n\nAdd the `X-Fleet-Scripts-Encoded: base64` header line to parse `install_script`, `uninstall_script`, `post_install_script`, and `pre_install_query` fields as base64-encoded rather than as-is.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateFleetMaintainedAppRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully created Fleet-maintained app",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateFleetMaintainedAppResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token"
          },
          "402": {
            "description": "Payment required - Fleet Premium license required"
          }
        }
      }
    }
  },
  "webhooks": {}
}