{
  "openapi": "3.1.0",
  "info": {
    "title": "Fleet REST API",
    "version": "1.0.0",
    "description": "REST API for Fleet device management platform",
    "contact": {
      "name": "Fleet",
      "url": "https://fleetdm.com"
    }
  },
  "servers": [
    {
      "url": "{protocol}://{host}",
      "description": "Fleet server",
      "variables": {
        "protocol": {
          "default": "https",
          "enum": [
            "https",
            "http"
          ],
          "description": "Protocol to use"
        },
        "host": {
          "default": "primo.mdm.getprimo.com",
          "description": "Fleet server hostname"
        }
      }
    }
  ],
  "tags": [
    {
      "name": "Authentication",
      "description": "User authentication and session management"
    },
    {
      "name": "Activities",
      "description": "Activity logs and audit trail"
    },
    {
      "name": "Fleet Configuration",
      "description": "Global Fleet configuration and settings"
    },
    {
      "name": "Certificates",
      "description": "Certificate authorities and certificates management"
    },
    {
      "name": "Conditional Access",
      "description": "Conditional access configuration for IdPs"
    },
    {
      "name": "File Carving",
      "description": "File carving sessions and data retrieval"
    },
    {
      "name": "Hosts",
      "description": "Host management, querying, and operations"
    },
    {
      "name": "Labels",
      "description": "Dynamic and manual label management"
    },
    {
      "name": "OS Settings",
      "description": "Configuration profiles and disk encryption"
    },
    {
      "name": "Setup Experience",
      "description": "MDM enrollment and bootstrap package configuration"
    },
    {
      "name": "Commands",
      "description": "Custom MDM commands"
    },
    {
      "name": "Integrations",
      "description": "Third-party integrations (APNs, ABM, VPP, SCIM)"
    },
    {
      "name": "Policies",
      "description": "Compliance policy management"
    },
    {
      "name": "Queries",
      "description": "Saved queries and live query execution"
    },
    {
      "name": "Scripts",
      "description": "Script management and execution"
    },
    {
      "name": "Sessions",
      "description": "User session management"
    },
    {
      "name": "Software",
      "description": "Software inventory and deployment"
    },
    {
      "name": "Vulnerabilities",
      "description": "Vulnerability information and tracking"
    },
    {
      "name": "Targets",
      "description": "Target selection for queries"
    },
    {
      "name": "Teams",
      "description": "Team management and configuration"
    },
    {
      "name": "Users",
      "description": "User management"
    },
    {
      "name": "Invites",
      "description": "User invitation management"
    },
    {
      "name": "Custom Variables",
      "description": "Custom variable management"
    },
    {
      "name": "Translator",
      "description": "Identifier translation"
    }
  ],
  "components": {
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "API token authentication. Get your token from My Account > Get API token in the Fleet UI."
      }
    },
    "schemas": {
      "LoginResponse": {
        "type": "object",
        "properties": {
          "user": {
            "$ref": "#/components/schemas/User"
          },
          "token": {
            "type": "string",
            "description": "API token for authentication"
          }
        },
        "required": [
          "user",
          "token"
        ]
      },
      "User": {
        "type": "object",
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the user was created"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the user was last updated"
          },
          "id": {
            "type": "integer",
            "description": "User ID"
          },
          "name": {
            "type": "string",
            "description": "User full name"
          },
          "email": {
            "type": "string",
            "format": "email",
            "description": "User email"
          },
          "enabled": {
            "type": "boolean",
            "description": "Whether the user is enabled"
          },
          "force_password_reset": {
            "type": "boolean",
            "description": "Whether user must reset password"
          },
          "gravatar_url": {
            "type": "string",
            "description": "Gravatar URL"
          },
          "sso_enabled": {
            "type": "boolean",
            "description": "Whether SSO is enabled"
          },
          "mfa_enabled": {
            "type": "boolean",
            "description": "Whether MFA is enabled"
          },
          "global_role": {
            "type": [
              "string",
              "null"
            ],
            "description": "Global role (admin, maintainer, observer, etc.)"
          },
          "teams": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TeamRole"
            },
            "description": "Team memberships"
          }
        },
        "required": [
          "created_at",
          "updated_at",
          "id",
          "name",
          "email",
          "enabled",
          "force_password_reset",
          "gravatar_url",
          "sso_enabled",
          "global_role",
          "teams"
        ]
      },
      "TeamRole": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Team ID"
          },
          "name": {
            "type": "string",
            "description": "Team name"
          },
          "role": {
            "type": "string",
            "description": "User role in the team"
          }
        },
        "required": [
          "id",
          "name",
          "role"
        ]
      },
      "LoginRequest": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "description": "The user's email",
            "example": "janedoe@example.com"
          },
          "password": {
            "type": "string",
            "description": "The user's plain text password",
            "example": "VArCjNW7CfsxGp67"
          }
        },
        "required": [
          "email",
          "password"
        ]
      },
      "ForgotPasswordRequest": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "description": "The email of the user requesting the reset password link"
          }
        },
        "required": [
          "email"
        ]
      },
      "ChangePasswordRequest": {
        "type": "object",
        "properties": {
          "old_password": {
            "type": "string",
            "description": "The user's old password"
          },
          "new_password": {
            "type": "string",
            "description": "The user's new password"
          }
        },
        "required": [
          "old_password",
          "new_password"
        ]
      },
      "ResetPasswordRequest": {
        "type": "object",
        "properties": {
          "new_password": {
            "type": "string",
            "description": "The new password"
          },
          "new_password_confirmation": {
            "type": "string",
            "description": "Confirmation for the new password"
          },
          "password_reset_token": {
            "type": "string",
            "description": "The token provided to the user in the password reset email"
          }
        },
        "required": [
          "new_password",
          "new_password_confirmation",
          "password_reset_token"
        ]
      },
      "MeResponse": {
        "type": "object",
        "properties": {
          "user": {
            "$ref": "#/components/schemas/User"
          },
          "available_teams": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AvailableTeam"
            },
            "description": "Teams available to the user"
          }
        },
        "required": [
          "user"
        ]
      },
      "AvailableTeam": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Team ID"
          },
          "name": {
            "type": "string",
            "description": "Team name"
          },
          "description": {
            "type": "string",
            "description": "Team description"
          }
        },
        "required": [
          "id",
          "name"
        ]
      },
      "PerformRequiredPasswordResetResponse": {
        "type": "object",
        "properties": {
          "user": {
            "$ref": "#/components/schemas/User"
          }
        },
        "required": [
          "user"
        ]
      },
      "PerformRequiredPasswordResetRequest": {
        "type": "object",
        "properties": {
          "new_password": {
            "type": "string",
            "description": "The new password"
          }
        },
        "required": [
          "new_password"
        ]
      },
      "SSOConfigResponse": {
        "type": "object",
        "properties": {
          "settings": {
            "$ref": "#/components/schemas/SSOSettings"
          }
        },
        "required": [
          "settings"
        ]
      },
      "SSOSettings": {
        "type": "object",
        "properties": {
          "idp_name": {
            "type": "string",
            "description": "Identity provider name"
          },
          "idp_image_url": {
            "type": "string",
            "description": "Identity provider image URL"
          },
          "sso_enabled": {
            "type": "boolean",
            "description": "Whether SSO is enabled"
          }
        },
        "required": [
          "idp_name",
          "idp_image_url",
          "sso_enabled"
        ]
      },
      "InitiateSSORequest": {
        "type": "object",
        "properties": {
          "relay_url": {
            "type": "string",
            "description": "The relative url to be navigated to after successful sign in"
          }
        },
        "required": [
          "relay_url"
        ]
      },
      "SSOCallbackRequest": {
        "type": "object",
        "properties": {
          "SAMLResponse": {
            "type": "string",
            "description": "The SAML response from the identity provider"
          }
        },
        "required": [
          "SAMLResponse"
        ]
      },
      "ListActivitiesResponse": {
        "type": "object",
        "properties": {
          "activities": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Activity"
            },
            "description": "Array of activities"
          },
          "meta": {
            "$ref": "#/components/schemas/Meta"
          }
        },
        "required": [
          "activities",
          "meta"
        ],
        "description": "Response for list activities endpoint"
      },
      "Activity": {
        "type": "object",
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the activity was created",
            "example": "2023-07-27T14:35:08Z"
          },
          "id": {
            "type": "integer",
            "description": "Unique identifier for the activity"
          },
          "actor_full_name": {
            "type": "string",
            "description": "Full name of the actor"
          },
          "actor_id": {
            "type": "integer",
            "description": "ID of the actor"
          },
          "actor_gravatar": {
            "type": "string",
            "description": "Gravatar URL of the actor"
          },
          "actor_email": {
            "type": "string",
            "format": "email",
            "description": "Email of the actor"
          },
          "type": {
            "type": "string",
            "description": "Type of activity",
            "example": "installed_software"
          },
          "fleet_initiated": {
            "type": "boolean",
            "description": "Whether the activity was initiated by Fleet"
          },
          "details": {
            "$ref": "#/components/schemas/ActivityDetails"
          }
        },
        "required": [
          "created_at",
          "id",
          "type",
          "fleet_initiated",
          "details"
        ],
        "description": "Represents a single activity in Fleet"
      },
      "ActivityDetails": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "description": "Status of the activity"
          },
          "host_id": {
            "type": "number",
            "description": "ID of the host"
          },
          "host_display_name": {
            "type": "string",
            "description": "Display name of the host"
          },
          "policy_id": {
            "type": [
              "number",
              "null"
            ],
            "description": "ID of the policy"
          },
          "policy_name": {
            "type": [
              "string",
              "null"
            ],
            "description": "Name of the policy"
          },
          "install_uuid": {
            "type": "string",
            "description": "Installation UUID"
          },
          "self_service": {
            "type": "boolean",
            "description": "Whether it was self-service"
          },
          "software_title": {
            "type": "string",
            "description": "Software title"
          },
          "software_package": {
            "type": "string",
            "description": "Software package name"
          },
          "team_id": {
            "type": "number",
            "description": "ID of the team"
          },
          "team_name": {
            "type": "string",
            "description": "Name of the team"
          }
        },
        "additionalProperties": {},
        "description": "Activity detail information varies by activity type"
      },
      "Meta": {
        "type": "object",
        "properties": {
          "has_next_results": {
            "type": "boolean",
            "description": "Whether there are more results available"
          },
          "has_previous_results": {
            "type": "boolean",
            "description": "Whether there are previous results"
          }
        },
        "required": [
          "has_next_results",
          "has_previous_results"
        ],
        "description": "Pagination metadata"
      },
      "CertificateResponse": {
        "type": "object",
        "properties": {
          "certificate_chain": {
            "type": "string",
            "description": "The Fleet certificate chain"
          }
        },
        "required": [
          "certificate_chain"
        ]
      },
      "ConfigResponse": {
        "type": "object",
        "properties": {
          "org_info": {
            "$ref": "#/components/schemas/OrgInfo"
          },
          "server_settings": {
            "$ref": "#/components/schemas/ServerSettings"
          },
          "smtp_settings": {
            "$ref": "#/components/schemas/SMTPSettings"
          },
          "sso_settings": {
            "$ref": "#/components/schemas/SSOSettingsFull"
          },
          "host_expiry_settings": {
            "$ref": "#/components/schemas/HostExpirySettings"
          },
          "activity_expiry_settings": {
            "$ref": "#/components/schemas/ActivityExpirySettings"
          },
          "features": {
            "$ref": "#/components/schemas/Features"
          },
          "license": {
            "$ref": "#/components/schemas/License"
          },
          "mdm": {
            "description": "MDM configuration"
          },
          "agent_options": {
            "description": "Agent options configuration"
          },
          "webhook_settings": {
            "description": "Webhook settings"
          },
          "integrations": {
            "description": "Integrations configuration"
          },
          "logging": {
            "description": "Logging configuration"
          },
          "update_interval": {
            "description": "Update interval configuration"
          },
          "vulnerabilities": {
            "description": "Vulnerabilities configuration"
          },
          "conditional_access": {
            "description": "Conditional access configuration"
          },
          "gitops": {
            "description": "GitOps configuration"
          }
        },
        "required": [
          "org_info",
          "server_settings",
          "host_expiry_settings",
          "activity_expiry_settings",
          "features",
          "license"
        ]
      },
      "OrgInfo": {
        "type": "object",
        "properties": {
          "org_name": {
            "type": "string",
            "description": "Organization name"
          },
          "org_logo_url": {
            "type": "string",
            "description": "Organization logo URL"
          },
          "org_logo_url_light_background": {
            "type": "string",
            "description": "Organization logo URL for light backgrounds"
          },
          "contact_url": {
            "type": "string",
            "description": "Contact URL"
          }
        },
        "required": [
          "org_name",
          "org_logo_url",
          "contact_url"
        ]
      },
      "ServerSettings": {
        "type": "object",
        "properties": {
          "server_url": {
            "type": "string",
            "description": "Fleet server URL"
          },
          "enable_analytics": {
            "type": "boolean",
            "description": "Whether analytics is enabled"
          },
          "live_query_disabled": {
            "type": "boolean",
            "description": "Whether live query is disabled"
          },
          "query_reports_disabled": {
            "type": "boolean",
            "description": "Whether query reports are disabled"
          },
          "ai_features_disabled": {
            "type": "boolean",
            "description": "Whether AI features are disabled"
          }
        },
        "required": [
          "server_url",
          "enable_analytics",
          "live_query_disabled",
          "query_reports_disabled",
          "ai_features_disabled"
        ]
      },
      "SMTPSettings": {
        "type": "object",
        "properties": {
          "enable_smtp": {
            "type": "boolean",
            "description": "Whether SMTP is enabled"
          },
          "configured": {
            "type": "boolean",
            "description": "Whether SMTP is configured"
          },
          "sender_address": {
            "type": "string",
            "description": "Sender email address"
          },
          "server": {
            "type": "string",
            "description": "SMTP server"
          },
          "port": {
            "type": "integer",
            "description": "SMTP port"
          },
          "authentication_type": {
            "type": "string",
            "description": "Authentication type"
          },
          "user_name": {
            "type": "string",
            "description": "SMTP username"
          },
          "password": {
            "type": "string",
            "description": "SMTP password (masked)"
          },
          "enable_ssl_tls": {
            "type": "boolean",
            "description": "Whether SSL/TLS is enabled"
          },
          "authentication_method": {
            "type": "string",
            "description": "Authentication method"
          },
          "domain": {
            "type": "string",
            "description": "SMTP domain"
          },
          "verify_ssl_certs": {
            "type": "boolean",
            "description": "Whether to verify SSL certificates"
          },
          "enable_start_tls": {
            "type": "boolean",
            "description": "Whether STARTTLS is enabled"
          }
        },
        "required": [
          "enable_smtp",
          "configured",
          "sender_address",
          "server",
          "port",
          "authentication_type",
          "user_name",
          "password",
          "enable_ssl_tls",
          "authentication_method",
          "domain",
          "verify_ssl_certs",
          "enable_start_tls"
        ]
      },
      "SSOSettingsFull": {
        "type": "object",
        "properties": {
          "entity_id": {
            "type": "string",
            "description": "Entity ID"
          },
          "issuer_uri": {
            "type": "string",
            "description": "Issuer URI"
          },
          "idp_image_url": {
            "type": "string",
            "description": "IdP image URL"
          },
          "metadata": {
            "type": "string",
            "description": "SAML metadata"
          },
          "metadata_url": {
            "type": "string",
            "description": "SAML metadata URL"
          },
          "idp_name": {
            "type": "string",
            "description": "IdP name"
          },
          "enable_sso": {
            "type": "boolean",
            "description": "Whether SSO is enabled"
          },
          "enable_sso_idp_login": {
            "type": "boolean",
            "description": "Whether IdP-initiated login is enabled"
          },
          "enable_jit_provisioning": {
            "type": "boolean",
            "description": "Whether JIT provisioning is enabled"
          },
          "sso_server_url": {
            "type": "string",
            "description": "SSO server URL"
          }
        },
        "required": [
          "entity_id",
          "issuer_uri",
          "idp_image_url",
          "metadata",
          "metadata_url",
          "idp_name",
          "enable_sso",
          "enable_sso_idp_login",
          "enable_jit_provisioning"
        ]
      },
      "HostExpirySettings": {
        "type": "object",
        "properties": {
          "host_expiry_enabled": {
            "type": "boolean",
            "description": "Whether host expiry is enabled"
          },
          "host_expiry_window": {
            "type": "integer",
            "description": "Host expiry window in days"
          }
        },
        "required": [
          "host_expiry_enabled",
          "host_expiry_window"
        ]
      },
      "ActivityExpirySettings": {
        "type": "object",
        "properties": {
          "activity_expiry_enabled": {
            "type": "boolean",
            "description": "Whether activity expiry is enabled"
          },
          "activity_expiry_window": {
            "type": "integer",
            "description": "Activity expiry window in days"
          }
        },
        "required": [
          "activity_expiry_enabled",
          "activity_expiry_window"
        ]
      },
      "Features": {
        "type": "object",
        "properties": {
          "enable_host_users": {
            "type": "boolean",
            "description": "Whether host users feature is enabled"
          },
          "enable_software_inventory": {
            "type": "boolean",
            "description": "Whether software inventory is enabled"
          },
          "additional_queries": {
            "description": "Additional queries configuration"
          }
        },
        "required": [
          "enable_host_users",
          "enable_software_inventory"
        ]
      },
      "License": {
        "type": "object",
        "properties": {
          "tier": {
            "type": "string",
            "description": "License tier"
          },
          "organization": {
            "type": "string",
            "description": "Organization name"
          },
          "device_count": {
            "type": "integer",
            "description": "Licensed device count"
          },
          "managed_cloud": {
            "type": "boolean",
            "description": "Whether this is managed cloud"
          },
          "expiration": {
            "type": "string",
            "format": "date-time",
            "description": "License expiration date"
          },
          "note": {
            "type": "string",
            "description": "License note"
          }
        },
        "required": [
          "tier",
          "organization",
          "device_count",
          "managed_cloud",
          "expiration",
          "note"
        ]
      },
      "UpdateConfigRequest": {
        "type": "object",
        "properties": {
          "org_info": {
            "type": "object",
            "properties": {
              "org_name": {
                "type": "string",
                "description": "Organization name"
              },
              "org_logo_url": {
                "type": "string",
                "description": "Organization logo URL"
              },
              "org_logo_url_light_background": {
                "type": "string",
                "description": "Organization logo URL for light backgrounds"
              },
              "contact_url": {
                "type": "string",
                "description": "Contact URL"
              }
            }
          },
          "server_settings": {
            "type": "object",
            "properties": {
              "server_url": {
                "type": "string",
                "description": "Fleet server URL"
              },
              "enable_analytics": {
                "type": "boolean",
                "description": "Whether analytics is enabled"
              },
              "live_query_disabled": {
                "type": "boolean",
                "description": "Whether live query is disabled"
              },
              "query_reports_disabled": {
                "type": "boolean",
                "description": "Whether query reports are disabled"
              },
              "ai_features_disabled": {
                "type": "boolean",
                "description": "Whether AI features are disabled"
              }
            }
          },
          "smtp_settings": {
            "type": "object",
            "properties": {
              "enable_smtp": {
                "type": "boolean",
                "description": "Whether SMTP is enabled"
              },
              "configured": {
                "type": "boolean",
                "description": "Whether SMTP is configured"
              },
              "sender_address": {
                "type": "string",
                "description": "Sender email address"
              },
              "server": {
                "type": "string",
                "description": "SMTP server"
              },
              "port": {
                "type": "integer",
                "description": "SMTP port"
              },
              "authentication_type": {
                "type": "string",
                "description": "Authentication type"
              },
              "user_name": {
                "type": "string",
                "description": "SMTP username"
              },
              "password": {
                "type": "string",
                "description": "SMTP password (masked)"
              },
              "enable_ssl_tls": {
                "type": "boolean",
                "description": "Whether SSL/TLS is enabled"
              },
              "authentication_method": {
                "type": "string",
                "description": "Authentication method"
              },
              "domain": {
                "type": "string",
                "description": "SMTP domain"
              },
              "verify_ssl_certs": {
                "type": "boolean",
                "description": "Whether to verify SSL certificates"
              },
              "enable_start_tls": {
                "type": "boolean",
                "description": "Whether STARTTLS is enabled"
              }
            }
          },
          "sso_settings": {
            "type": "object",
            "properties": {
              "entity_id": {
                "type": "string",
                "description": "Entity ID"
              },
              "issuer_uri": {
                "type": "string",
                "description": "Issuer URI"
              },
              "idp_image_url": {
                "type": "string",
                "description": "IdP image URL"
              },
              "metadata": {
                "type": "string",
                "description": "SAML metadata"
              },
              "metadata_url": {
                "type": "string",
                "description": "SAML metadata URL"
              },
              "idp_name": {
                "type": "string",
                "description": "IdP name"
              },
              "enable_sso": {
                "type": "boolean",
                "description": "Whether SSO is enabled"
              },
              "enable_sso_idp_login": {
                "type": "boolean",
                "description": "Whether IdP-initiated login is enabled"
              },
              "enable_jit_provisioning": {
                "type": "boolean",
                "description": "Whether JIT provisioning is enabled"
              },
              "sso_server_url": {
                "type": "string",
                "description": "SSO server URL"
              }
            }
          },
          "host_expiry_settings": {
            "type": "object",
            "properties": {
              "host_expiry_enabled": {
                "type": "boolean",
                "description": "Whether host expiry is enabled"
              },
              "host_expiry_window": {
                "type": "integer",
                "description": "Host expiry window in days"
              }
            }
          },
          "activity_expiry_settings": {
            "type": "object",
            "properties": {
              "activity_expiry_enabled": {
                "type": "boolean",
                "description": "Whether activity expiry is enabled"
              },
              "activity_expiry_window": {
                "type": "integer",
                "description": "Activity expiry window in days"
              }
            }
          },
          "features": {
            "type": "object",
            "properties": {
              "enable_host_users": {
                "type": "boolean",
                "description": "Whether host users feature is enabled"
              },
              "enable_software_inventory": {
                "type": "boolean",
                "description": "Whether software inventory is enabled"
              },
              "additional_queries": {
                "description": "Additional queries configuration"
              }
            }
          },
          "agent_options": {},
          "webhook_settings": {},
          "integrations": {},
          "mdm": {},
          "gitops": {},
          "conditional_access": {},
          "scripts": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "yara_rules": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "EnrollSecretSpecResponse": {
        "type": "object",
        "properties": {
          "spec": {
            "type": "object",
            "properties": {
              "secrets": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/EnrollSecret"
                }
              }
            },
            "required": [
              "secrets"
            ]
          }
        },
        "required": [
          "spec"
        ]
      },
      "EnrollSecret": {
        "type": "object",
        "properties": {
          "secret": {
            "type": "string",
            "description": "The enroll secret string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the secret was created"
          },
          "team_id": {
            "type": [
              "integer",
              "null"
            ],
            "description": "Team ID if team-specific"
          }
        },
        "required": [
          "secret",
          "created_at"
        ]
      },
      "ApplyEnrollSecretSpecRequest": {
        "type": "object",
        "properties": {
          "spec": {
            "type": "object",
            "properties": {
              "secrets": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "secret": {
                      "type": "string",
                      "description": "The enroll secret string"
                    }
                  },
                  "required": [
                    "secret"
                  ]
                }
              }
            },
            "required": [
              "secrets"
            ]
          }
        },
        "required": [
          "spec"
        ]
      },
      "TeamSecretsResponse": {
        "type": "object",
        "properties": {
          "secrets": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EnrollSecret"
            }
          }
        },
        "required": [
          "secrets"
        ]
      },
      "ModifyTeamSecretsRequest": {
        "type": "object",
        "properties": {
          "secrets": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "secret": {
                  "type": "string",
                  "description": "The enroll secret string"
                }
              },
              "required": [
                "secret"
              ]
            }
          }
        },
        "required": [
          "secrets"
        ]
      },
      "VersionResponse": {
        "type": "object",
        "properties": {
          "version": {
            "type": "string",
            "description": "Fleet version"
          },
          "branch": {
            "type": "string",
            "description": "Git branch"
          },
          "revision": {
            "type": "string",
            "description": "Git revision"
          },
          "go_version": {
            "type": "string",
            "description": "Go version"
          },
          "build_date": {
            "type": "string",
            "description": "Build date"
          },
          "build_user": {
            "type": "string",
            "description": "Build user"
          }
        },
        "required": [
          "version",
          "branch",
          "revision",
          "go_version",
          "build_date",
          "build_user"
        ]
      },
      "CreateCertificateAuthorityResponse": {
        "type": "object",
        "properties": {
          "certificate_authority": {
            "$ref": "#/components/schemas/CertificateAuthority"
          }
        },
        "required": [
          "certificate_authority"
        ]
      },
      "CertificateAuthority": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Certificate authority ID"
          },
          "name": {
            "type": "string",
            "description": "Certificate authority name"
          },
          "not_valid_after": {
            "type": "string",
            "format": "date-time",
            "description": "Certificate expiration date"
          },
          "sha256_fingerprint": {
            "type": "string",
            "description": "SHA256 fingerprint of the certificate"
          }
        },
        "required": [
          "id",
          "name",
          "not_valid_after",
          "sha256_fingerprint"
        ]
      },
      "CreateCertificateAuthorityRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Certificate authority name"
          },
          "certificate": {
            "type": "string",
            "description": "PEM-encoded certificate"
          },
          "key": {
            "type": "string",
            "description": "PEM-encoded private key"
          }
        },
        "required": [
          "name",
          "certificate"
        ]
      },
      "UploadCertificateResponse": {
        "type": "object",
        "properties": {
          "certificate": {
            "$ref": "#/components/schemas/Certificate"
          }
        },
        "required": [
          "certificate"
        ]
      },
      "Certificate": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Certificate ID"
          },
          "name": {
            "type": "string",
            "description": "Certificate name"
          },
          "serial": {
            "type": "string",
            "description": "Certificate serial number"
          },
          "not_valid_after": {
            "type": "string",
            "format": "date-time",
            "description": "Certificate expiration date"
          },
          "certificate_authority_id": {
            "type": "integer",
            "description": "Associated certificate authority ID"
          },
          "sha256_fingerprint": {
            "type": "string",
            "description": "SHA256 fingerprint of the certificate"
          }
        },
        "required": [
          "id",
          "name",
          "serial",
          "not_valid_after",
          "certificate_authority_id",
          "sha256_fingerprint"
        ]
      },
      "UploadCertificateRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Certificate name"
          },
          "certificate": {
            "type": "string",
            "description": "PEM-encoded certificate"
          }
        },
        "required": [
          "name",
          "certificate"
        ]
      },
      "GetCertificateAuthorityResponse": {
        "type": "object",
        "properties": {
          "certificate_authority": {
            "$ref": "#/components/schemas/CertificateAuthority"
          }
        },
        "required": [
          "certificate_authority"
        ]
      },
      "UpdateCertificateAuthorityRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Certificate authority name"
          }
        }
      },
      "ListCertificateAuthoritiesResponse": {
        "type": "object",
        "properties": {
          "certificate_authorities": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CertificateAuthority"
            }
          }
        },
        "required": [
          "certificate_authorities"
        ]
      },
      "ListCertificatesResponse": {
        "type": "object",
        "properties": {
          "certificates": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Certificate"
            }
          }
        },
        "required": [
          "certificates"
        ]
      },
      "GetCertificateResponse": {
        "type": "object",
        "properties": {
          "certificate": {
            "$ref": "#/components/schemas/Certificate"
          }
        },
        "required": [
          "certificate"
        ]
      },
      "RequestCertificateResponse": {
        "type": "object",
        "properties": {
          "certificate": {
            "type": "string",
            "description": "PEM-encoded certificate"
          },
          "key": {
            "type": "string",
            "description": "PEM-encoded private key"
          }
        },
        "required": [
          "certificate",
          "key"
        ]
      },
      "RequestCertificateRequest": {
        "type": "object",
        "properties": {
          "common_name": {
            "type": "string",
            "description": "Common name for the certificate"
          },
          "validity_days": {
            "type": "integer",
            "description": "Number of days the certificate should be valid"
          }
        },
        "required": [
          "common_name"
        ]
      },
      "ListCarvesResponse": {
        "type": "object",
        "properties": {
          "carves": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CarveSession"
            }
          }
        },
        "required": [
          "carves"
        ]
      },
      "CarveSession": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Carve session ID"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the carve was created"
          },
          "host_id": {
            "type": "integer",
            "description": "Host ID"
          },
          "name": {
            "type": "string",
            "description": "Carve name"
          },
          "block_count": {
            "type": "integer",
            "description": "Number of blocks"
          },
          "block_size": {
            "type": "integer",
            "description": "Block size in bytes"
          },
          "carve_size": {
            "type": "integer",
            "description": "Total carve size in bytes"
          },
          "carve_id": {
            "type": "string",
            "description": "Carve ID"
          },
          "request_id": {
            "type": "string",
            "description": "Request ID"
          },
          "session_id": {
            "type": "string",
            "description": "Session ID"
          },
          "expired": {
            "type": "boolean",
            "description": "Whether the carve has expired"
          },
          "max_block": {
            "type": "integer",
            "description": "Maximum block number received"
          }
        },
        "required": [
          "id",
          "created_at",
          "host_id",
          "name",
          "block_count",
          "block_size",
          "carve_size",
          "carve_id",
          "request_id",
          "session_id",
          "expired",
          "max_block"
        ]
      },
      "GetCarveResponse": {
        "type": "object",
        "properties": {
          "carve": {
            "$ref": "#/components/schemas/CarveSession"
          }
        },
        "required": [
          "carve"
        ]
      },
      "GetCarveBlockResponse": {
        "type": "object",
        "properties": {
          "data": {
            "type": "string",
            "description": "Base64-encoded block data"
          }
        },
        "required": [
          "data"
        ]
      },
      "ListHostsResponse": {
        "type": "object",
        "properties": {
          "hosts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Host"
            }
          },
          "software": {},
          "software_title": {},
          "munki_issue": {},
          "mobile_device_management_solution": {}
        },
        "required": [
          "hosts"
        ]
      },
      "Host": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Host ID"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the host was created"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the host was last updated"
          },
          "detail_updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When host details were last updated"
          },
          "label_updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When labels were last updated"
          },
          "policy_updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When policies were last updated"
          },
          "last_enrolled_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the host last enrolled"
          },
          "seen_time": {
            "type": "string",
            "format": "date-time",
            "description": "When the host was last seen"
          },
          "refetch_requested": {
            "type": "boolean",
            "description": "Whether a refetch was requested"
          },
          "hostname": {
            "type": "string",
            "description": "Host hostname"
          },
          "uuid": {
            "type": "string",
            "description": "Host UUID"
          },
          "platform": {
            "type": "string",
            "description": "Host platform (darwin, windows, linux, etc.)"
          },
          "osquery_version": {
            "type": "string",
            "description": "Osquery version"
          },
          "os_version": {
            "type": "string",
            "description": "Operating system version"
          },
          "build": {
            "type": "string",
            "description": "OS build"
          },
          "platform_like": {
            "type": "string",
            "description": "Platform-like"
          },
          "code_name": {
            "type": "string",
            "description": "OS code name"
          },
          "uptime": {
            "type": "integer",
            "description": "Uptime in seconds"
          },
          "memory": {
            "type": "integer",
            "description": "Memory in bytes"
          },
          "cpu_type": {
            "type": "string",
            "description": "CPU type"
          },
          "cpu_subtype": {
            "type": "string",
            "description": "CPU subtype"
          },
          "cpu_brand": {
            "type": "string",
            "description": "CPU brand"
          },
          "cpu_physical_cores": {
            "type": "integer",
            "description": "Physical CPU cores"
          },
          "cpu_logical_cores": {
            "type": "integer",
            "description": "Logical CPU cores"
          },
          "hardware_vendor": {
            "type": "string",
            "description": "Hardware vendor"
          },
          "hardware_model": {
            "type": "string",
            "description": "Hardware model"
          },
          "hardware_version": {
            "type": "string",
            "description": "Hardware version"
          },
          "hardware_serial": {
            "type": "string",
            "description": "Hardware serial number"
          },
          "computer_name": {
            "type": "string",
            "description": "Computer name"
          },
          "display_name": {
            "type": "string",
            "description": "Display name"
          },
          "public_ip": {
            "type": "string",
            "description": "Public IP address"
          },
          "primary_ip": {
            "type": "string",
            "description": "Primary IP address"
          },
          "primary_mac": {
            "type": "string",
            "description": "Primary MAC address"
          },
          "distributed_interval": {
            "type": "integer",
            "description": "Distributed interval"
          },
          "config_tls_refresh": {
            "type": "integer",
            "description": "Config TLS refresh interval"
          },
          "logger_tls_period": {
            "type": "integer",
            "description": "Logger TLS period"
          },
          "team_id": {
            "type": [
              "integer",
              "null"
            ],
            "description": "Team ID"
          },
          "team_name": {
            "type": [
              "string",
              "null"
            ],
            "description": "Team name"
          },
          "gigs_disk_space_available": {
            "type": "number",
            "description": "Available disk space in GB"
          },
          "percent_disk_space_available": {
            "type": "number",
            "description": "Available disk space percentage"
          },
          "gigs_total_disk_space": {
            "type": "number",
            "description": "Total disk space in GB"
          },
          "disk_encryption_enabled": {
            "type": "boolean",
            "description": "Whether disk encryption is enabled"
          },
          "status": {
            "type": "string",
            "enum": [
              "online",
              "offline",
              "missing",
              "new"
            ],
            "description": "Host status"
          }
        },
        "required": [
          "id",
          "created_at",
          "updated_at",
          "hostname",
          "uuid",
          "platform"
        ]
      },
      "HostCountResponse": {
        "type": "object",
        "properties": {
          "count": {
            "type": "integer",
            "description": "Total host count"
          }
        },
        "required": [
          "count"
        ]
      },
      "HostSummaryResponse": {
        "type": "object",
        "properties": {
          "totals_hosts_count": {
            "type": "integer",
            "description": "Total hosts count"
          },
          "online_count": {
            "type": "integer",
            "description": "Online hosts count"
          },
          "offline_count": {
            "type": "integer",
            "description": "Offline hosts count"
          },
          "mia_count": {
            "type": "integer",
            "description": "Missing in action count"
          },
          "missing_30_days_count": {
            "type": "integer",
            "description": "Missing 30 days count"
          },
          "new_count": {
            "type": "integer",
            "description": "New hosts count"
          },
          "all_linux_count": {
            "type": "integer",
            "description": "All Linux hosts count"
          },
          "low_disk_space_count": {
            "type": "integer",
            "description": "Low disk space count"
          },
          "builtin_labels": {
            "type": "array",
            "items": {},
            "description": "Built-in labels"
          },
          "platforms": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "platform": {
                  "type": "string"
                },
                "hosts_count": {
                  "type": "integer"
                }
              },
              "required": [
                "platform",
                "hosts_count"
              ]
            },
            "description": "Platform counts"
          }
        },
        "required": [
          "totals_hosts_count",
          "online_count",
          "offline_count",
          "mia_count",
          "missing_30_days_count",
          "new_count",
          "all_linux_count"
        ]
      },
      "GetHostResponse": {
        "type": "object",
        "properties": {
          "host": {
            "allOf": [
              {
                "$ref": "#/components/schemas/Host"
              },
              {
                "type": "object",
                "properties": {
                  "labels": {
                    "type": "array",
                    "items": {}
                  },
                  "packs": {
                    "type": "array",
                    "items": {}
                  },
                  "policies": {
                    "type": "array",
                    "items": {}
                  },
                  "software": {
                    "type": "array",
                    "items": {}
                  },
                  "users": {
                    "type": "array",
                    "items": {}
                  }
                }
              }
            ]
          }
        },
        "required": [
          "host"
        ]
      },
      "TransferHostsRequest": {
        "type": "object",
        "properties": {
          "team_id": {
            "type": [
              "integer",
              "null"
            ],
            "description": "Target team ID (null for no team)"
          },
          "hosts": {
            "type": "array",
            "items": {
              "type": "integer"
            },
            "description": "Array of host IDs to transfer"
          }
        },
        "required": [
          "team_id",
          "hosts"
        ]
      },
      "TransferHostsByFilterRequest": {
        "type": "object",
        "properties": {
          "team_id": {
            "type": [
              "integer",
              "null"
            ],
            "description": "Target team ID (null for no team)"
          },
          "filters": {
            "type": "object",
            "properties": {
              "label_id": {
                "type": "integer"
              },
              "status": {
                "type": "string"
              },
              "query": {
                "type": "string"
              },
              "team_id": {
                "type": "integer"
              }
            }
          }
        },
        "required": [
          "team_id"
        ]
      },
      "DeleteHostsRequest": {
        "type": "object",
        "properties": {
          "ids": {
            "type": "array",
            "items": {
              "type": "integer"
            },
            "description": "Array of host IDs to delete"
          },
          "filters": {
            "type": "object",
            "properties": {
              "label_id": {
                "type": "integer"
              },
              "status": {
                "type": "string"
              },
              "query": {
                "type": "string"
              },
              "team_id": {
                "type": "integer"
              }
            }
          }
        }
      },
      "DeviceMappingRequest": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "description": "Email to associate with the host"
          }
        },
        "required": [
          "email"
        ]
      },
      "HostHealthResponse": {
        "type": "object",
        "properties": {
          "host_id": {
            "type": "integer"
          },
          "os_version": {
            "type": "string"
          },
          "disk_encryption_enabled": {
            "type": "boolean"
          },
          "failing_policies_count": {
            "type": "integer"
          },
          "vulnerable_software_count": {
            "type": "integer"
          }
        },
        "required": [
          "host_id"
        ]
      },
      "HostMDMResponse": {
        "type": "object",
        "properties": {
          "enrollment_status": {
            "type": [
              "string",
              "null"
            ]
          },
          "server_url": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": [
              "string",
              "null"
            ]
          },
          "id": {
            "type": [
              "integer",
              "null"
            ]
          }
        }
      },
      "HostEncryptionKeyResponse": {
        "type": "object",
        "properties": {
          "host_id": {
            "type": "integer"
          },
          "encryption_key": {
            "type": "object",
            "properties": {
              "key": {
                "type": "string"
              },
              "updated_at": {
                "type": "string",
                "format": "date-time"
              }
            },
            "required": [
              "key",
              "updated_at"
            ]
          }
        },
        "required": [
          "host_id",
          "encryption_key"
        ]
      },
      "HostActivitiesResponse": {
        "type": "object",
        "properties": {
          "activities": {
            "type": "array",
            "items": {}
          },
          "meta": {
            "$ref": "#/components/schemas/Meta"
          }
        },
        "required": [
          "activities",
          "meta"
        ]
      },
      "HostLabelsRequest": {
        "type": "object",
        "properties": {
          "labels": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Label names to add or remove"
          }
        },
        "required": [
          "labels"
        ]
      },
      "HostQueryRequest": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "description": "SQL query to run"
          }
        },
        "required": [
          "query"
        ]
      },
      "CreateLabelResponse": {
        "type": "object",
        "properties": {
          "label": {
            "$ref": "#/components/schemas/Label"
          }
        },
        "required": [
          "label"
        ]
      },
      "Label": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Label ID"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the label was created"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the label was last updated"
          },
          "name": {
            "type": "string",
            "description": "Label name"
          },
          "description": {
            "type": "string",
            "description": "Label description"
          },
          "query": {
            "type": "string",
            "description": "Label query (for dynamic labels)"
          },
          "label_type": {
            "type": "string",
            "enum": [
              "regular",
              "builtin"
            ],
            "description": "Label type"
          },
          "label_membership_type": {
            "type": "string",
            "enum": [
              "dynamic",
              "manual"
            ],
            "description": "Label membership type"
          },
          "host_count": {
            "type": "integer",
            "description": "Number of hosts with this label"
          },
          "display_text": {
            "type": "string",
            "description": "Display text"
          },
          "slug": {
            "type": "string",
            "description": "Label slug"
          }
        },
        "required": [
          "id",
          "created_at",
          "updated_at",
          "name"
        ]
      },
      "CreateLabelRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Label name"
          },
          "description": {
            "type": "string",
            "description": "Label description"
          },
          "query": {
            "type": "string",
            "description": "SQL query for dynamic labels"
          },
          "platform": {
            "type": "string",
            "description": "Platform filter (comma-separated)"
          },
          "hosts": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Host identifiers for manual labels"
          }
        },
        "required": [
          "name"
        ]
      },
      "GetLabelResponse": {
        "type": "object",
        "properties": {
          "label": {
            "$ref": "#/components/schemas/Label"
          }
        },
        "required": [
          "label"
        ]
      },
      "UpdateLabelRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Label name"
          },
          "description": {
            "type": "string",
            "description": "Label description"
          },
          "hosts": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Host identifiers for manual labels"
          }
        }
      },
      "LabelsSummaryResponse": {
        "type": "object",
        "properties": {
          "labels": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LabelSummaryItem"
            }
          }
        },
        "required": [
          "labels"
        ]
      },
      "LabelSummaryItem": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Label ID"
          },
          "name": {
            "type": "string",
            "description": "Label name"
          },
          "description": {
            "type": "string",
            "description": "Label description"
          },
          "label_type": {
            "type": "string",
            "description": "Label type"
          }
        },
        "required": [
          "id",
          "name"
        ]
      },
      "ListLabelsResponse": {
        "type": "object",
        "properties": {
          "labels": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Label"
            }
          }
        },
        "required": [
          "labels"
        ]
      },
      "ListPoliciesResponse": {
        "type": "object",
        "properties": {
          "policies": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Policy"
            }
          }
        },
        "required": [
          "policies"
        ]
      },
      "Policy": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Policy ID"
          },
          "name": {
            "type": "string",
            "description": "Policy name"
          },
          "query": {
            "type": "string",
            "description": "Policy SQL query"
          },
          "critical": {
            "type": "boolean",
            "description": "Whether the policy is critical"
          },
          "description": {
            "type": "string",
            "description": "Policy description"
          },
          "author_id": {
            "type": "integer",
            "description": "Author user ID"
          },
          "author_name": {
            "type": "string",
            "description": "Author name"
          },
          "author_email": {
            "type": "string",
            "description": "Author email"
          },
          "team_id": {
            "type": [
              "integer",
              "null"
            ],
            "description": "Team ID"
          },
          "resolution": {
            "type": [
              "string",
              "null"
            ],
            "description": "Resolution instructions"
          },
          "platform": {
            "type": "string",
            "description": "Target platforms"
          },
          "calendar_events_enabled": {
            "type": "boolean",
            "description": "Whether calendar events are enabled"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the policy was created"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the policy was last updated"
          },
          "passing_host_count": {
            "type": "integer",
            "description": "Count of hosts passing"
          },
          "failing_host_count": {
            "type": "integer",
            "description": "Count of hosts failing"
          },
          "host_count_updated_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "description": "When host counts were updated"
          }
        },
        "required": [
          "id",
          "name",
          "query"
        ]
      },
      "PolicyCountResponse": {
        "type": "object",
        "properties": {
          "count": {
            "type": "integer",
            "description": "Total policy count"
          }
        },
        "required": [
          "count"
        ]
      },
      "GetPolicyResponse": {
        "type": "object",
        "properties": {
          "policy": {
            "$ref": "#/components/schemas/Policy"
          }
        },
        "required": [
          "policy"
        ]
      },
      "CreatePolicyRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Policy name"
          },
          "query": {
            "type": "string",
            "description": "Policy SQL query"
          },
          "description": {
            "type": "string",
            "description": "Policy description"
          },
          "resolution": {
            "type": "string",
            "description": "Resolution instructions"
          },
          "platform": {
            "type": "string",
            "description": "Target platforms (comma-separated)"
          },
          "critical": {
            "type": "boolean",
            "description": "Whether the policy is critical"
          },
          "calendar_events_enabled": {
            "type": "boolean",
            "description": "Whether to enable calendar events"
          },
          "software_title_id": {
            "type": "integer",
            "description": "Software title ID to install on failure"
          },
          "script_id": {
            "type": "integer",
            "description": "Script ID to run on failure"
          }
        },
        "required": [
          "name",
          "query"
        ]
      },
      "DeletePoliciesResponse": {
        "type": "object",
        "properties": {
          "deleted": {
            "type": "integer",
            "description": "Number of policies deleted"
          }
        },
        "required": [
          "deleted"
        ]
      },
      "DeletePoliciesRequest": {
        "type": "object",
        "properties": {
          "ids": {
            "type": "array",
            "items": {
              "type": "integer"
            },
            "description": "Array of policy IDs to delete"
          }
        },
        "required": [
          "ids"
        ]
      },
      "UpdatePolicyRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Policy name"
          },
          "query": {
            "type": "string",
            "description": "Policy SQL query"
          },
          "description": {
            "type": "string",
            "description": "Policy description"
          },
          "resolution": {
            "type": [
              "string",
              "null"
            ],
            "description": "Resolution instructions"
          },
          "platform": {
            "type": "string",
            "description": "Target platforms"
          },
          "critical": {
            "type": "boolean",
            "description": "Whether the policy is critical"
          },
          "calendar_events_enabled": {
            "type": "boolean",
            "description": "Whether to enable calendar events"
          },
          "software_title_id": {
            "type": [
              "integer",
              "null"
            ],
            "description": "Software title ID to install on failure"
          },
          "script_id": {
            "type": [
              "integer",
              "null"
            ],
            "description": "Script ID to run on failure"
          }
        }
      },
      "ResetAutomationRequest": {
        "type": "object",
        "properties": {
          "team_ids": {
            "type": "array",
            "items": {
              "type": "integer"
            },
            "description": "Team IDs"
          },
          "policy_ids": {
            "type": "array",
            "items": {
              "type": "integer"
            },
            "description": "Policy IDs"
          }
        }
      },
      "CreateFleetMaintainedAppResponse": {
        "type": "object",
        "properties": {
          "software_title_id": {
            "type": "integer",
            "description": "The ID of the created software title",
            "example": 234
          }
        },
        "required": [
          "software_title_id"
        ],
        "description": "Response for create Fleet-maintained app endpoint"
      },
      "CreateFleetMaintainedAppRequest": {
        "type": "object",
        "properties": {
          "fleet_maintained_app_id": {
            "type": "integer",
            "description": "The ID of Fleet-maintained app",
            "example": 3
          },
          "team_id": {
            "type": "integer",
            "description": "The team ID. Adds Fleet-maintained app to the specified team",
            "example": 2
          },
          "install_script": {
            "type": "string",
            "description": "Command that Fleet runs to install software. If not specified Fleet runs default install command for each Fleet-maintained app"
          },
          "pre_install_query": {
            "type": "string",
            "description": "Query that is pre-install condition. If the query doesn't return any result, Fleet won't proceed to install"
          },
          "post_install_script": {
            "type": "string",
            "description": "The contents of the script to run after install. If the specified script fails (exit code non-zero) software install will be marked as failed and rolled back"
          },
          "self_service": {
            "type": "boolean",
            "description": "Self-service software is optional and can be installed by the end user"
          },
          "labels_include_any": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Target hosts that have any label, specified by label name, in the array"
          },
          "labels_exclude_any": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Target hosts that don't have any label, specified by label name, in the array"
          },
          "automatic_install": {
            "type": "boolean",
            "description": "Create a policy that triggers a software install only on hosts missing the software"
          }
        },
        "required": [
          "fleet_maintained_app_id",
          "team_id"
        ],
        "description": "Request body for creating a Fleet-maintained app"
      }
    },
    "parameters": {}
  },
  "paths": {
    "/api/v1/fleet/login": {
      "post": {
        "summary": "Log in",
        "description": "Authenticates the user with the specified credentials. Use the token returned from this endpoint to authenticate further API requests.\n\n> Logging in via the API is not supported for SSO and MFA users. The API token can instead be retrieved from the \"My account\" page in the UI (/profile).",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully authenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoginResponse"
                }
              }
            }
          },
          "202": {
            "description": "MFA required - Magic link email sent"
          },
          "401": {
            "description": "Authentication failed"
          },
          "429": {
            "description": "Too many requests - Rate limiting"
          }
        }
      }
    },
    "/api/v1/fleet/logout": {
      "post": {
        "summary": "Log out",
        "description": "Logs out the authenticated user.",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully logged out"
          }
        }
      }
    },
    "/api/v1/fleet/forgot_password": {
      "post": {
        "summary": "Forgot password",
        "description": "Sends a password reset email to the specified email. Requires that SMTP or SES is configured for your Fleet server.",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ForgotPasswordRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password reset email sent"
          },
          "500": {
            "description": "Email not configured"
          }
        }
      }
    },
    "/api/v1/fleet/change_password": {
      "post": {
        "summary": "Update password",
        "description": "Changes the password for the authenticated user.",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChangePasswordRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password changed successfully"
          },
          "422": {
            "description": "Validation failed - old password does not match"
          }
        }
      }
    },
    "/api/v1/fleet/reset_password": {
      "post": {
        "summary": "Reset password",
        "description": "Resets a user's password. Which user is determined by the password reset token used.",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResetPasswordRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password reset successfully"
          }
        }
      }
    },
    "/api/v1/fleet/me": {
      "get": {
        "summary": "Me",
        "description": "Retrieves the user data for the authenticated user.",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved user data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MeResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/perform_required_password_reset": {
      "post": {
        "summary": "Perform required password reset",
        "description": "Resets the password of the authenticated user. Requires that `force_password_reset` is set to `true` prior to the request.",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PerformRequiredPasswordResetRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password reset successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PerformRequiredPasswordResetResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/sso": {
      "get": {
        "summary": "SSO config",
        "description": "Gets the current SSO configuration.",
        "tags": [
          "Authentication"
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved SSO configuration",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SSOConfigResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Initiate SSO",
        "description": "Initiates SSO authentication. A successful response contains an HTTP cookie that needs to be sent on the callback request.",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/InitiateSSORequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "SSO initiated successfully"
          },
          "500": {
            "description": "SSO configuration error"
          }
        }
      }
    },
    "/api/v1/fleet/sso/callback": {
      "post": {
        "summary": "SSO callback",
        "description": "This is the callback endpoint that the identity provider will use to send security assertions to Fleet.",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SSOCallbackRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "SSO authentication successful"
          }
        }
      }
    },
    "/api/v1/fleet/activities": {
      "get": {
        "summary": "List activities",
        "description": "Returns a list of the activities that have been performed in Fleet.\n\nFor a comprehensive list of activity types and detailed information, please see the [audit logs](https://fleetdm.com/docs/using-fleet/audit-activities) page.",
        "tags": [
          "Activities"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number of the results to fetch",
              "example": 0
            },
            "required": false,
            "description": "Page number of the results to fetch",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page",
              "example": 10
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "What to order results by. Can be any column in the activities table",
              "example": "created_at"
            },
            "required": false,
            "description": "What to order results by. Can be any column in the activities table",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "The direction of the order given the order key. Default is \"asc\"",
              "example": "desc"
            },
            "required": false,
            "description": "The direction of the order given the order key. Default is \"asc\"",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query keywords. Searchable fields include actor_full_name and actor_email"
            },
            "required": false,
            "description": "Search query keywords. Searchable fields include actor_full_name and actor_email",
            "name": "query",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Indicates the activity type to filter by"
            },
            "required": false,
            "description": "Indicates the activity type to filter by",
            "name": "activity_type",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "format": "date-time",
              "description": "Filters to include only activities that happened after this date"
            },
            "required": false,
            "description": "Filters to include only activities that happened after this date",
            "name": "start_created_at",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "format": "date-time",
              "description": "Filters to include only activities that happened before this date. If not specified, set to now"
            },
            "required": false,
            "description": "Filters to include only activities that happened before this date. If not specified, set to now",
            "name": "end_created_at",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved activities",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListActivitiesResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token"
          }
        }
      }
    },
    "/api/v1/fleet/config/certificate": {
      "get": {
        "summary": "Get certificate chain",
        "description": "Returns the Fleet certificate chain.",
        "tags": [
          "Fleet Configuration"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved certificate chain",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CertificateResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/config": {
      "get": {
        "summary": "Get configuration",
        "description": "Returns all information about the Fleet's configuration.\n\nThe `agent_options`, `sso_settings` and `smtp_settings` fields are only returned for admin and GitOps users with global access.",
        "tags": [
          "Fleet Configuration"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved configuration",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConfigResponse"
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update configuration",
        "description": "Modifies the Fleet's configuration with the supplied information.",
        "tags": [
          "Fleet Configuration"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Force apply agent options even with validation errors"
            },
            "required": false,
            "description": "Force apply agent options even with validation errors",
            "name": "force",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Validate configuration without applying changes"
            },
            "required": false,
            "description": "Validate configuration without applying changes",
            "name": "dry_run",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateConfigRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Configuration updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConfigResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/spec/enroll_secret": {
      "get": {
        "summary": "Get enroll secrets for global scope",
        "description": "Returns the valid global enroll secrets.",
        "tags": [
          "Fleet Configuration"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved enroll secrets",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EnrollSecretSpecResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Apply enroll secrets for global scope",
        "description": "Replaces all existing global enroll secrets with the provided secrets.",
        "tags": [
          "Fleet Configuration"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApplyEnrollSecretSpecRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Enroll secrets applied successfully"
          }
        }
      }
    },
    "/api/v1/fleet/teams/{id}/secrets": {
      "get": {
        "summary": "Get team enroll secrets",
        "description": "Returns the valid enroll secrets for a team.",
        "tags": [
          "Fleet Configuration"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved team secrets",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TeamSecretsResponse"
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Modify team enroll secrets",
        "description": "Replaces all existing enroll secrets for a team with the provided secrets.",
        "tags": [
          "Fleet Configuration"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ModifyTeamSecretsRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Team secrets modified successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TeamSecretsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/version": {
      "get": {
        "summary": "Get version",
        "description": "Returns the Fleet server version information.",
        "tags": [
          "Fleet Configuration"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved version",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VersionResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/certificate_authorities": {
      "post": {
        "summary": "Create certificate authority",
        "description": "Creates a new certificate authority.",
        "tags": [
          "Certificates"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateCertificateAuthorityRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Certificate authority created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateCertificateAuthorityResponse"
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "List certificate authorities",
        "description": "Returns a list of all certificate authorities.",
        "tags": [
          "Certificates"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved certificate authorities",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListCertificateAuthoritiesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/certificates": {
      "post": {
        "summary": "Upload certificate",
        "description": "Uploads a new certificate.",
        "tags": [
          "Certificates"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UploadCertificateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Certificate uploaded successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UploadCertificateResponse"
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "List certificates",
        "description": "Returns a list of all certificates.",
        "tags": [
          "Certificates"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved certificates",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListCertificatesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/certificate_authorities/{id}": {
      "patch": {
        "summary": "Update certificate authority",
        "description": "Updates an existing certificate authority.",
        "tags": [
          "Certificates"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Certificate authority ID"
            },
            "required": false,
            "description": "Certificate authority ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateCertificateAuthorityRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Certificate authority updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetCertificateAuthorityResponse"
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "Get certificate authority",
        "description": "Returns a specific certificate authority.",
        "tags": [
          "Certificates"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Certificate authority ID"
            },
            "required": false,
            "description": "Certificate authority ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved certificate authority",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetCertificateAuthorityResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete certificate authority",
        "description": "Deletes a certificate authority.",
        "tags": [
          "Certificates"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Certificate authority ID"
            },
            "required": false,
            "description": "Certificate authority ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Certificate authority deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/certificates/{id}": {
      "get": {
        "summary": "Get certificate",
        "description": "Returns a specific certificate.",
        "tags": [
          "Certificates"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Certificate ID"
            },
            "required": false,
            "description": "Certificate ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved certificate",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetCertificateResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete certificate",
        "description": "Deletes a certificate.",
        "tags": [
          "Certificates"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Certificate ID"
            },
            "required": false,
            "description": "Certificate ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Certificate deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/certificate_authorities/{id}/request_certificate": {
      "post": {
        "summary": "Request certificate",
        "description": "Requests a new certificate from a certificate authority.",
        "tags": [
          "Certificates"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Certificate authority ID"
            },
            "required": false,
            "description": "Certificate authority ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RequestCertificateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Certificate requested successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RequestCertificateResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/conditional_access/idp/signing_cert": {
      "get": {
        "summary": "Get IdP signing certificate",
        "description": "Returns the IdP signing certificate for conditional access.",
        "tags": [
          "Conditional Access"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved signing certificate",
            "content": {
              "application/x-pem-file": {
                "schema": {
                  "type": "string",
                  "description": "PEM-encoded certificate"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/conditional_access/idp/apple/profile": {
      "get": {
        "summary": "Get Apple conditional access profile",
        "description": "Returns the Apple configuration profile for conditional access.",
        "tags": [
          "Conditional Access"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved Apple profile",
            "content": {
              "application/x-apple-aspen-config": {
                "schema": {
                  "type": "string",
                  "description": "Apple configuration profile"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/conditional-access/microsoft": {
      "delete": {
        "summary": "Delete Microsoft conditional access",
        "description": "Deletes the Microsoft Entra conditional access configuration.",
        "tags": [
          "Conditional Access"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Microsoft conditional access deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/carves": {
      "get": {
        "summary": "List file carving sessions",
        "description": "Returns a list of file carving sessions.",
        "tags": [
          "File Carving"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include expired carves"
            },
            "required": false,
            "description": "Include expired carves",
            "name": "expired",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved carves",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListCarvesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/carves/{id}": {
      "get": {
        "summary": "Get file carving session",
        "description": "Returns a specific file carving session.",
        "tags": [
          "File Carving"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Carve session ID"
            },
            "required": false,
            "description": "Carve session ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved carve",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetCarveResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/carves/{id}/block/{block_id}": {
      "get": {
        "summary": "Get carve block",
        "description": "Returns a specific block from a file carving session.",
        "tags": [
          "File Carving"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Carve session ID"
            },
            "required": false,
            "description": "Carve session ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Block ID"
            },
            "required": false,
            "description": "Block ID",
            "name": "block_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved carve block",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetCarveBlockResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/hosts": {
      "get": {
        "summary": "List hosts",
        "description": "Returns a list of all hosts in Fleet.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Label ID filter"
            },
            "required": false,
            "description": "Label ID filter",
            "name": "label_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "new",
                "online",
                "offline",
                "missing"
              ],
              "description": "Status filter"
            },
            "required": false,
            "description": "Status filter",
            "name": "status",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "MDM solution ID filter"
            },
            "required": false,
            "description": "MDM solution ID filter",
            "name": "mdm_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "MDM solution name filter"
            },
            "required": false,
            "description": "MDM solution name filter",
            "name": "mdm_name",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "automatic",
                "manual",
                "unenrolled",
                "pending"
              ],
              "description": "MDM enrollment status filter"
            },
            "required": false,
            "description": "MDM enrollment status filter",
            "name": "mdm_enrollment_status",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "verified",
                "verifying",
                "pending",
                "failed"
              ],
              "description": "macOS settings status filter"
            },
            "required": false,
            "description": "macOS settings status filter",
            "name": "macos_settings",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Munki issue ID filter"
            },
            "required": false,
            "description": "Munki issue ID filter",
            "name": "munki_issue_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software ID filter"
            },
            "required": false,
            "description": "Software ID filter",
            "name": "software_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software version ID filter"
            },
            "required": false,
            "description": "Software version ID filter",
            "name": "software_version_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID filter"
            },
            "required": false,
            "description": "Software title ID filter",
            "name": "software_title_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "installed",
                "pending",
                "failed"
              ],
              "description": "Software status filter"
            },
            "required": false,
            "description": "Software status filter",
            "name": "software_status",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "OS ID filter"
            },
            "required": false,
            "description": "OS ID filter",
            "name": "os_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "OS name filter"
            },
            "required": false,
            "description": "OS name filter",
            "name": "os_name",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "OS version filter"
            },
            "required": false,
            "description": "OS version filter",
            "name": "os_version",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "CVE filter"
            },
            "required": false,
            "description": "CVE filter",
            "name": "vulnerability",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include device mapping"
            },
            "required": false,
            "description": "Include device mapping",
            "name": "device_mapping",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include software"
            },
            "required": false,
            "description": "Include software",
            "name": "populate_software",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include policies"
            },
            "required": false,
            "description": "Include policies",
            "name": "populate_policies",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include users"
            },
            "required": false,
            "description": "Include users",
            "name": "populate_users",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include labels"
            },
            "required": false,
            "description": "Include labels",
            "name": "populate_labels",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Low disk space threshold in GB"
            },
            "required": false,
            "description": "Low disk space threshold in GB",
            "name": "low_disk_space",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Exclude hosts failing policies"
            },
            "required": false,
            "description": "Exclude hosts failing policies",
            "name": "disable_failing_policies",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Policy ID filter"
            },
            "required": false,
            "description": "Policy ID filter",
            "name": "policy_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "pass",
                "fail"
              ],
              "description": "Policy response filter"
            },
            "required": false,
            "description": "Policy response filter",
            "name": "policy_response",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "installed",
                "pending",
                "failed"
              ],
              "description": "Bootstrap package status filter"
            },
            "required": false,
            "description": "Bootstrap package status filter",
            "name": "bootstrap_package",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved hosts",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListHostsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/hosts/count": {
      "get": {
        "summary": "Count hosts",
        "description": "Returns the count of hosts matching the filter criteria.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Label ID filter"
            },
            "required": false,
            "description": "Label ID filter",
            "name": "label_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "new",
                "online",
                "offline",
                "missing"
              ],
              "description": "Status filter"
            },
            "required": false,
            "description": "Status filter",
            "name": "status",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "MDM solution ID filter"
            },
            "required": false,
            "description": "MDM solution ID filter",
            "name": "mdm_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "MDM solution name filter"
            },
            "required": false,
            "description": "MDM solution name filter",
            "name": "mdm_name",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "automatic",
                "manual",
                "unenrolled",
                "pending"
              ],
              "description": "MDM enrollment status filter"
            },
            "required": false,
            "description": "MDM enrollment status filter",
            "name": "mdm_enrollment_status",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "verified",
                "verifying",
                "pending",
                "failed"
              ],
              "description": "macOS settings status filter"
            },
            "required": false,
            "description": "macOS settings status filter",
            "name": "macos_settings",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Munki issue ID filter"
            },
            "required": false,
            "description": "Munki issue ID filter",
            "name": "munki_issue_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software ID filter"
            },
            "required": false,
            "description": "Software ID filter",
            "name": "software_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software version ID filter"
            },
            "required": false,
            "description": "Software version ID filter",
            "name": "software_version_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID filter"
            },
            "required": false,
            "description": "Software title ID filter",
            "name": "software_title_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "installed",
                "pending",
                "failed"
              ],
              "description": "Software status filter"
            },
            "required": false,
            "description": "Software status filter",
            "name": "software_status",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "OS ID filter"
            },
            "required": false,
            "description": "OS ID filter",
            "name": "os_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "OS name filter"
            },
            "required": false,
            "description": "OS name filter",
            "name": "os_name",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "OS version filter"
            },
            "required": false,
            "description": "OS version filter",
            "name": "os_version",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "CVE filter"
            },
            "required": false,
            "description": "CVE filter",
            "name": "vulnerability",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include device mapping"
            },
            "required": false,
            "description": "Include device mapping",
            "name": "device_mapping",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include software"
            },
            "required": false,
            "description": "Include software",
            "name": "populate_software",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include policies"
            },
            "required": false,
            "description": "Include policies",
            "name": "populate_policies",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include users"
            },
            "required": false,
            "description": "Include users",
            "name": "populate_users",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include labels"
            },
            "required": false,
            "description": "Include labels",
            "name": "populate_labels",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Low disk space threshold in GB"
            },
            "required": false,
            "description": "Low disk space threshold in GB",
            "name": "low_disk_space",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Exclude hosts failing policies"
            },
            "required": false,
            "description": "Exclude hosts failing policies",
            "name": "disable_failing_policies",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Policy ID filter"
            },
            "required": false,
            "description": "Policy ID filter",
            "name": "policy_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "pass",
                "fail"
              ],
              "description": "Policy response filter"
            },
            "required": false,
            "description": "Policy response filter",
            "name": "policy_response",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "installed",
                "pending",
                "failed"
              ],
              "description": "Bootstrap package status filter"
            },
            "required": false,
            "description": "Bootstrap package status filter",
            "name": "bootstrap_package",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved host count",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostCountResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/host_summary": {
      "get": {
        "summary": "Get host summary",
        "description": "Returns a summary of host counts by status and platform.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Platform filter"
            },
            "required": false,
            "description": "Platform filter",
            "name": "platform",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Low disk space threshold in GB"
            },
            "required": false,
            "description": "Low disk space threshold in GB",
            "name": "low_disk_space",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved host summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostSummaryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}": {
      "get": {
        "summary": "Get host",
        "description": "Returns a specific host by ID.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Exclude software"
            },
            "required": false,
            "description": "Exclude software",
            "name": "exclude_software",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved host",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetHostResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete host",
        "description": "Deletes a host from Fleet.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Host deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/identifier/{identifier}": {
      "get": {
        "summary": "Get host by identifier",
        "description": "Returns a host by its UUID, osquery host ID, hostname, or node key.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Host identifier (UUID, osquery host ID, hostname, or node key)"
            },
            "required": true,
            "description": "Host identifier (UUID, osquery host ID, hostname, or node key)",
            "name": "identifier",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved host",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetHostResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/device/{token}": {
      "get": {
        "summary": "Get device by token",
        "description": "Returns a host using the device token. Useful for device-side authentication.",
        "tags": [
          "Hosts"
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Device token"
            },
            "required": true,
            "description": "Device token",
            "name": "token",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved device",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetHostResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/refetch": {
      "post": {
        "summary": "Refetch host",
        "description": "Instructs Fleet to refetch a host's data.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Refetch requested successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/transfer": {
      "post": {
        "summary": "Transfer hosts to a team",
        "description": "Transfers specific hosts to a team (or no team).",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TransferHostsRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Hosts transferred successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/transfer/filter": {
      "post": {
        "summary": "Transfer hosts by filter",
        "description": "Transfers hosts matching the filter criteria to a team.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TransferHostsByFilterRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Hosts transferred successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/mdm": {
      "delete": {
        "summary": "Turn off MDM for host",
        "description": "Turns off MDM for a specific host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "MDM turned off successfully"
          }
        }
      },
      "get": {
        "summary": "Get host MDM info",
        "description": "Returns MDM information for a specific host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved host MDM info",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostMDMResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/hosts/delete": {
      "post": {
        "summary": "Bulk delete hosts",
        "description": "Deletes multiple hosts by ID or filter.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeleteHostsRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Hosts deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/device_mapping": {
      "put": {
        "summary": "Update device mapping",
        "description": "Updates the device mapping (email) for a host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeviceMappingRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Device mapping updated successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/health": {
      "get": {
        "summary": "Get host health",
        "description": "Returns health metrics for a specific host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved host health",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostHealthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/hosts/summary/mdm": {
      "get": {
        "summary": "Get MDM summary",
        "description": "Returns MDM enrollment summary for hosts.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Platform filter (darwin, windows)"
            },
            "required": false,
            "description": "Platform filter (darwin, windows)",
            "name": "platform",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved MDM summary"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/macadmins": {
      "get": {
        "summary": "Get host macadmins data",
        "description": "Returns Munki and MDM data for a macOS host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved macadmins data"
          }
        }
      }
    },
    "/api/v1/fleet/macadmins": {
      "get": {
        "summary": "Get aggregate macadmins data",
        "description": "Returns aggregate Munki and MDM data for all macOS hosts.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved macadmins data"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/software": {
      "get": {
        "summary": "Get host software",
        "description": "Returns software installed on a specific host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Filter to only vulnerable software"
            },
            "required": false,
            "description": "Filter to only vulnerable software",
            "name": "vulnerable",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Filter to software available for install"
            },
            "required": false,
            "description": "Filter to software available for install",
            "name": "available_for_install",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved host software"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/report": {
      "get": {
        "summary": "Get hosts report",
        "description": "Returns a report of hosts matching the filter criteria.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "enum": [
                "csv",
                "json"
              ],
              "description": "Report format"
            },
            "required": false,
            "description": "Report format",
            "name": "format",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Comma-separated list of columns"
            },
            "required": false,
            "description": "Comma-separated list of columns",
            "name": "columns",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "label_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "software_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "software_version_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "software_title_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "policy_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string"
            },
            "required": false,
            "name": "vulnerability",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved hosts report"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/encryption_key": {
      "get": {
        "summary": "Get host encryption key",
        "description": "Returns the disk encryption key for a host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved encryption key",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostEncryptionKeyResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/certificates": {
      "get": {
        "summary": "Get host certificates",
        "description": "Returns certificates installed on a host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "per_page",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved host certificates"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/configuration_profiles": {
      "get": {
        "summary": "Get host configuration profiles",
        "description": "Returns configuration profiles for a host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved configuration profiles"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/lock": {
      "post": {
        "summary": "Lock host",
        "description": "Locks a host via MDM.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Return the unlock PIN in response"
            },
            "required": false,
            "description": "Return the unlock PIN in response",
            "name": "view_pin",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Lock command sent successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/unlock": {
      "post": {
        "summary": "Unlock host",
        "description": "Unlocks a host via MDM.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Unlock command sent successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/wipe": {
      "post": {
        "summary": "Wipe host",
        "description": "Wipes a host via MDM.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Wipe command sent successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/activities": {
      "get": {
        "summary": "Get host activities",
        "description": "Returns past activities for a specific host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "per_page",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved host activities",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostActivitiesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/activities/upcoming": {
      "get": {
        "summary": "Get host upcoming activities",
        "description": "Returns upcoming activities for a specific host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "per_page",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved upcoming activities"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/activities/upcoming/{activity_id}": {
      "delete": {
        "summary": "Cancel upcoming activity",
        "description": "Cancels a pending/upcoming activity for a host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "description": "Activity UUID"
            },
            "required": true,
            "description": "Activity UUID",
            "name": "activity_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Activity cancelled successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/labels": {
      "post": {
        "summary": "Add labels to host",
        "description": "Adds labels to a specific host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/HostLabelsRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Labels added successfully"
          }
        }
      },
      "delete": {
        "summary": "Remove labels from host",
        "description": "Removes labels from a specific host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/HostLabelsRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Labels removed successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/query": {
      "post": {
        "summary": "Run live query on host",
        "description": "Runs a live query on a specific host.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/HostQueryRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Query executed successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/identifier/{identifier}/query": {
      "post": {
        "summary": "Run live query on host by identifier",
        "description": "Runs a live query on a host identified by UUID, hostname, etc.",
        "tags": [
          "Hosts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Host identifier"
            },
            "required": true,
            "description": "Host identifier",
            "name": "identifier",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/HostQueryRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Query executed successfully"
          }
        }
      }
    },
    "/api/v1/fleet/labels": {
      "post": {
        "summary": "Create label",
        "description": "Creates a new label.",
        "tags": [
          "Labels"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateLabelRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Label created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateLabelResponse"
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "List labels",
        "description": "Returns a list of all labels.",
        "tags": [
          "Labels"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved labels",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListLabelsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/labels/{id}": {
      "patch": {
        "summary": "Update label",
        "description": "Updates an existing label.",
        "tags": [
          "Labels"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Label ID"
            },
            "required": false,
            "description": "Label ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateLabelRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Label updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetLabelResponse"
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "Get label",
        "description": "Returns a specific label by ID.",
        "tags": [
          "Labels"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Label ID"
            },
            "required": false,
            "description": "Label ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved label",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetLabelResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/labels/summary": {
      "get": {
        "summary": "Get labels summary",
        "description": "Returns a summary of all labels.",
        "tags": [
          "Labels"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved labels summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LabelsSummaryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/labels/{id}/hosts": {
      "get": {
        "summary": "List hosts in label",
        "description": "Returns hosts that belong to the specified label.",
        "tags": [
          "Labels"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Label ID"
            },
            "required": false,
            "description": "Label ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Label ID filter"
            },
            "required": false,
            "description": "Label ID filter",
            "name": "label_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "new",
                "online",
                "offline",
                "missing"
              ],
              "description": "Status filter"
            },
            "required": false,
            "description": "Status filter",
            "name": "status",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "MDM solution ID filter"
            },
            "required": false,
            "description": "MDM solution ID filter",
            "name": "mdm_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "MDM solution name filter"
            },
            "required": false,
            "description": "MDM solution name filter",
            "name": "mdm_name",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "automatic",
                "manual",
                "unenrolled",
                "pending"
              ],
              "description": "MDM enrollment status filter"
            },
            "required": false,
            "description": "MDM enrollment status filter",
            "name": "mdm_enrollment_status",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "verified",
                "verifying",
                "pending",
                "failed"
              ],
              "description": "macOS settings status filter"
            },
            "required": false,
            "description": "macOS settings status filter",
            "name": "macos_settings",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Munki issue ID filter"
            },
            "required": false,
            "description": "Munki issue ID filter",
            "name": "munki_issue_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software ID filter"
            },
            "required": false,
            "description": "Software ID filter",
            "name": "software_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software version ID filter"
            },
            "required": false,
            "description": "Software version ID filter",
            "name": "software_version_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID filter"
            },
            "required": false,
            "description": "Software title ID filter",
            "name": "software_title_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "installed",
                "pending",
                "failed"
              ],
              "description": "Software status filter"
            },
            "required": false,
            "description": "Software status filter",
            "name": "software_status",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "OS ID filter"
            },
            "required": false,
            "description": "OS ID filter",
            "name": "os_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "OS name filter"
            },
            "required": false,
            "description": "OS name filter",
            "name": "os_name",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "OS version filter"
            },
            "required": false,
            "description": "OS version filter",
            "name": "os_version",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "CVE filter"
            },
            "required": false,
            "description": "CVE filter",
            "name": "vulnerability",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include device mapping"
            },
            "required": false,
            "description": "Include device mapping",
            "name": "device_mapping",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include software"
            },
            "required": false,
            "description": "Include software",
            "name": "populate_software",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include policies"
            },
            "required": false,
            "description": "Include policies",
            "name": "populate_policies",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include users"
            },
            "required": false,
            "description": "Include users",
            "name": "populate_users",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include labels"
            },
            "required": false,
            "description": "Include labels",
            "name": "populate_labels",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Low disk space threshold in GB"
            },
            "required": false,
            "description": "Low disk space threshold in GB",
            "name": "low_disk_space",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Exclude hosts failing policies"
            },
            "required": false,
            "description": "Exclude hosts failing policies",
            "name": "disable_failing_policies",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Policy ID filter"
            },
            "required": false,
            "description": "Policy ID filter",
            "name": "policy_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "pass",
                "fail"
              ],
              "description": "Policy response filter"
            },
            "required": false,
            "description": "Policy response filter",
            "name": "policy_response",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "installed",
                "pending",
                "failed"
              ],
              "description": "Bootstrap package status filter"
            },
            "required": false,
            "description": "Bootstrap package status filter",
            "name": "bootstrap_package",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved hosts in label",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListHostsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/labels/{name}": {
      "delete": {
        "summary": "Delete label by name",
        "description": "Deletes a label by its name.",
        "tags": [
          "Labels"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Label name"
            },
            "required": true,
            "description": "Label name",
            "name": "name",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Label deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/labels/id/{id}": {
      "delete": {
        "summary": "Delete label by ID",
        "description": "Deletes a label by its ID.",
        "tags": [
          "Labels"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Label ID"
            },
            "required": false,
            "description": "Label ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Label deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/configuration_profiles": {
      "post": {
        "summary": "Add custom OS setting (configuration profile)",
        "description": "Adds a custom configuration profile for macOS or Windows.\n\nAccepts .mobileconfig (macOS) or .xml (Windows) files.",
        "tags": [
          "OS Settings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID (omit for no team)"
            },
            "required": false,
            "description": "Team ID (omit for no team)",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "profile": {
                    "description": "The profile file (.mobileconfig or .xml)"
                  },
                  "labels": {
                    "type": "string",
                    "description": "Comma-separated list of label names"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Profile added successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "profile_uuid": {
                      "type": "string",
                      "description": "UUID of the created profile"
                    }
                  },
                  "required": [
                    "profile_uuid"
                  ]
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "List custom OS settings (configuration profiles)",
        "description": "Returns a list of custom configuration profiles.",
        "tags": [
          "OS Settings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved profiles",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "profiles": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "profile_uuid": {
                            "type": "string"
                          },
                          "team_id": {
                            "type": [
                              "integer",
                              "null"
                            ]
                          },
                          "name": {
                            "type": "string"
                          },
                          "platform": {
                            "type": "string"
                          },
                          "identifier": {
                            "type": "string"
                          },
                          "created_at": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updated_at": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "labels": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string"
                                },
                                "broken": {
                                  "type": "boolean"
                                }
                              },
                              "required": [
                                "name",
                                "broken"
                              ]
                            }
                          }
                        },
                        "required": [
                          "profile_uuid",
                          "team_id",
                          "name",
                          "platform",
                          "identifier",
                          "created_at",
                          "updated_at"
                        ]
                      }
                    },
                    "meta": {
                      "type": "object",
                      "properties": {
                        "has_next_results": {
                          "type": "boolean"
                        },
                        "has_previous_results": {
                          "type": "boolean"
                        }
                      },
                      "required": [
                        "has_next_results",
                        "has_previous_results"
                      ]
                    }
                  },
                  "required": [
                    "profiles",
                    "meta"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/configuration_profiles/{profile_uuid}": {
      "get": {
        "summary": "Download custom OS setting (configuration profile)",
        "description": "Downloads a configuration profile. Use ?alt=media to download the raw file.",
        "tags": [
          "OS Settings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Profile UUID"
            },
            "required": true,
            "description": "Profile UUID",
            "name": "profile_uuid",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "media"
              ],
              "description": "Set to media to download the raw file"
            },
            "required": false,
            "description": "Set to media to download the raw file",
            "name": "alt",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Profile retrieved successfully"
          }
        }
      },
      "delete": {
        "summary": "Delete custom OS setting (configuration profile)",
        "description": "Deletes a custom configuration profile.",
        "tags": [
          "OS Settings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Profile UUID"
            },
            "required": true,
            "description": "Profile UUID",
            "name": "profile_uuid",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Profile deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/configuration_profiles/{profile_uuid}/resend": {
      "post": {
        "summary": "Resend configuration profile to host",
        "description": "Resends a configuration profile to a specific host.",
        "tags": [
          "OS Settings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "description": "Profile UUID"
            },
            "required": true,
            "description": "Profile UUID",
            "name": "profile_uuid",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Profile resend initiated successfully"
          }
        }
      }
    },
    "/api/v1/fleet/configuration_profiles/batch": {
      "post": {
        "summary": "Batch apply custom OS settings",
        "description": "Applies multiple configuration profiles at once.",
        "tags": [
          "OS Settings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Validate without applying"
            },
            "required": false,
            "description": "Validate without applying",
            "name": "dry_run",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "profiles": {
                    "description": "Profile files"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Profiles applied successfully"
          }
        }
      }
    },
    "/api/v1/fleet/device/{token}/configuration_profiles/{profile_uuid}/resend": {
      "post": {
        "summary": "Resend configuration profile via device token",
        "description": "Resends a configuration profile to a device using its token.",
        "tags": [
          "OS Settings"
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Device token"
            },
            "required": true,
            "description": "Device token",
            "name": "token",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "description": "Profile UUID"
            },
            "required": true,
            "description": "Profile UUID",
            "name": "profile_uuid",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Profile resend initiated successfully"
          }
        }
      }
    },
    "/api/v1/fleet/configuration_profiles/resend/batch": {
      "post": {
        "summary": "Batch resend configuration profiles",
        "description": "Resends configuration profiles to multiple hosts.",
        "tags": [
          "OS Settings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "profile_uuid": {
                    "type": "string",
                    "description": "Profile UUID"
                  },
                  "host_ids": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    },
                    "description": "Host IDs"
                  }
                },
                "required": [
                  "profile_uuid"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Profiles resend initiated successfully"
          }
        }
      }
    },
    "/api/v1/fleet/disk_encryption": {
      "post": {
        "summary": "Update disk encryption enforcement",
        "description": "Updates disk encryption enforcement settings.",
        "tags": [
          "OS Settings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "enable_disk_encryption": {
                    "type": "boolean",
                    "description": "Whether to enable disk encryption"
                  }
                },
                "required": [
                  "enable_disk_encryption"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Disk encryption settings updated"
          }
        }
      },
      "get": {
        "summary": "Get disk encryption",
        "description": "Gets disk encryption enforcement status.",
        "tags": [
          "OS Settings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Disk encryption settings retrieved"
          }
        }
      }
    },
    "/api/v1/fleet/configuration_profiles/summary": {
      "get": {
        "summary": "Get OS settings status",
        "description": "Returns summary statistics for configuration profile deployment.",
        "tags": [
          "OS Settings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Profile summary retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "verified": {
                      "type": "integer"
                    },
                    "verifying": {
                      "type": "integer"
                    },
                    "pending": {
                      "type": "integer"
                    },
                    "failed": {
                      "type": "integer"
                    }
                  },
                  "required": [
                    "verified",
                    "verifying",
                    "pending",
                    "failed"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/configuration_profile/{profile_uuid}/status": {
      "get": {
        "summary": "Get profile status",
        "description": "Returns deployment status for a specific profile.",
        "tags": [
          "OS Settings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Profile UUID"
            },
            "required": true,
            "description": "Profile UUID",
            "name": "profile_uuid",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Profile status retrieved"
          }
        }
      }
    },
    "/api/v1/fleet/enrollment_profiles/automatic": {
      "post": {
        "summary": "Upload automatic enrollment profile",
        "description": "Uploads a custom automatic enrollment (DEP) profile for macOS hosts.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "profile": {
                    "description": "The automatic enrollment profile file (.json)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Profile uploaded successfully"
          }
        }
      },
      "get": {
        "summary": "Get automatic enrollment profile",
        "description": "Returns the automatic enrollment profile metadata.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Profile metadata retrieved"
          }
        }
      },
      "delete": {
        "summary": "Delete automatic enrollment profile",
        "description": "Deletes the custom automatic enrollment profile.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Profile deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/enrollment_profiles/ota": {
      "get": {
        "summary": "Get OTA enrollment profile",
        "description": "Returns the OTA (over-the-air) enrollment profile for manual MDM enrollment.",
        "tags": [
          "Setup Experience"
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Enroll secret"
            },
            "required": true,
            "description": "Enroll secret",
            "name": "enroll_secret",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "OTA profile retrieved",
            "content": {
              "application/x-apple-aspen-config": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/enrollment_profiles/manual": {
      "get": {
        "summary": "Get manual enrollment profile",
        "description": "Returns the manual enrollment profile for MDM enrollment.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Manual enrollment profile retrieved",
            "content": {
              "application/x-apple-aspen-config": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/bootstrap": {
      "post": {
        "summary": "Upload bootstrap package",
        "description": "Uploads a bootstrap package for macOS hosts during DEP enrollment.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "package": {
                    "description": "The bootstrap package (.pkg)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Bootstrap package uploaded successfully"
          }
        }
      },
      "get": {
        "summary": "Download bootstrap package",
        "description": "Downloads the bootstrap package.",
        "tags": [
          "Setup Experience"
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Bootstrap package token"
            },
            "required": true,
            "description": "Bootstrap package token",
            "name": "token",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Bootstrap package downloaded",
            "content": {
              "application/octet-stream": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/bootstrap/{team_id}/metadata": {
      "get": {
        "summary": "Get bootstrap package metadata",
        "description": "Returns metadata about the bootstrap package.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID (0 for no team)"
            },
            "required": false,
            "description": "Team ID (0 for no team)",
            "name": "team_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Bootstrap package metadata retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string"
                    },
                    "team_id": {
                      "type": "integer"
                    },
                    "sha256": {
                      "type": "string"
                    },
                    "token": {
                      "type": "string"
                    },
                    "created_at": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "name",
                    "team_id",
                    "sha256",
                    "token",
                    "created_at"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/bootstrap/{team_id}": {
      "delete": {
        "summary": "Delete bootstrap package",
        "description": "Deletes the bootstrap package.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Bootstrap package deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/bootstrap/summary": {
      "get": {
        "summary": "Get bootstrap package summary",
        "description": "Returns summary statistics for bootstrap package installation.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Bootstrap summary retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "installed": {
                      "type": "integer"
                    },
                    "pending": {
                      "type": "integer"
                    },
                    "failed": {
                      "type": "integer"
                    }
                  },
                  "required": [
                    "installed",
                    "pending",
                    "failed"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/setup_experience": {
      "patch": {
        "summary": "Update setup experience",
        "description": "Updates setup experience settings.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "enable_release_device_manually": {
                    "type": "boolean"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Setup experience updated"
          }
        }
      }
    },
    "/api/v1/fleet/setup_experience/eula": {
      "post": {
        "summary": "Upload EULA",
        "description": "Uploads a EULA (End User License Agreement) PDF.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "eula": {
                    "description": "The EULA PDF file"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "EULA uploaded successfully"
          }
        }
      }
    },
    "/api/v1/fleet/setup_experience/eula/metadata": {
      "get": {
        "summary": "Get EULA metadata",
        "description": "Returns metadata about the uploaded EULA.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "EULA metadata retrieved"
          }
        }
      }
    },
    "/api/v1/fleet/setup_experience/eula/{token}": {
      "delete": {
        "summary": "Delete EULA",
        "description": "Deletes the uploaded EULA.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "EULA token"
            },
            "required": true,
            "description": "EULA token",
            "name": "token",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "EULA deleted successfully"
          }
        }
      },
      "get": {
        "summary": "Download EULA",
        "description": "Downloads the EULA PDF.",
        "tags": [
          "Setup Experience"
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "EULA token"
            },
            "required": true,
            "description": "EULA token",
            "name": "token",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "EULA downloaded",
            "content": {
              "application/pdf": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/setup_experience/software": {
      "get": {
        "summary": "Get setup experience software",
        "description": "Returns software configured for the setup experience.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Setup experience software retrieved"
          }
        }
      },
      "put": {
        "summary": "Update setup experience software",
        "description": "Updates software configured for the setup experience.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "software_title_ids": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    },
                    "description": "Software title IDs"
                  }
                },
                "required": [
                  "software_title_ids"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Setup experience software updated"
          }
        }
      }
    },
    "/api/v1/fleet/setup_experience/script": {
      "post": {
        "summary": "Upload setup experience script",
        "description": "Uploads a script to run during setup experience.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "script": {
                    "description": "The script file"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Script uploaded successfully"
          }
        }
      },
      "put": {
        "summary": "Update setup experience script",
        "description": "Updates the setup experience script.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "script": {
                    "description": "The script file"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Script updated successfully"
          }
        }
      },
      "get": {
        "summary": "Get setup experience script",
        "description": "Returns the setup experience script. Use ?alt=media to download.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "media"
              ],
              "description": "Set to media to download the raw script"
            },
            "required": false,
            "description": "Set to media to download the raw script",
            "name": "alt",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Script retrieved"
          }
        }
      },
      "delete": {
        "summary": "Delete setup experience script",
        "description": "Deletes the setup experience script.",
        "tags": [
          "Setup Experience"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Script deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/commands/run": {
      "post": {
        "summary": "Run custom MDM command",
        "description": "Sends a custom MDM command to a host.",
        "tags": [
          "Commands"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "command": {
                    "type": "string",
                    "description": "Base64-encoded MDM command XML"
                  },
                  "host_uuids": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Target host UUIDs"
                  }
                },
                "required": [
                  "command",
                  "host_uuids"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Command sent successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "command_uuid": {
                      "type": "string",
                      "description": "UUID of the sent command"
                    },
                    "request_type": {
                      "type": "string",
                      "description": "MDM command type"
                    }
                  },
                  "required": [
                    "command_uuid",
                    "request_type"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/commands/results": {
      "get": {
        "summary": "Get custom MDM command results",
        "description": "Returns the results of a custom MDM command.",
        "tags": [
          "Commands"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Command UUID"
            },
            "required": true,
            "description": "Command UUID",
            "name": "command_uuid",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Command results retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "results": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "host_uuid": {
                            "type": "string"
                          },
                          "command_uuid": {
                            "type": "string"
                          },
                          "status": {
                            "type": "string"
                          },
                          "updated_at": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "request_type": {
                            "type": "string"
                          },
                          "hostname": {
                            "type": "string"
                          },
                          "result": {}
                        },
                        "required": [
                          "host_uuid",
                          "command_uuid",
                          "status",
                          "updated_at",
                          "request_type",
                          "hostname"
                        ]
                      }
                    }
                  },
                  "required": [
                    "results"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/commands": {
      "get": {
        "summary": "List custom MDM commands",
        "description": "Returns a list of custom MDM commands.",
        "tags": [
          "Commands"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Commands list retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "commands": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "command_uuid": {
                            "type": "string"
                          },
                          "request_type": {
                            "type": "string"
                          },
                          "status": {
                            "type": "string"
                          },
                          "hostname": {
                            "type": "string"
                          },
                          "host_uuid": {
                            "type": "string"
                          },
                          "updated_at": {
                            "type": "string",
                            "format": "date-time"
                          }
                        },
                        "required": [
                          "command_uuid",
                          "request_type",
                          "status",
                          "hostname",
                          "host_uuid",
                          "updated_at"
                        ]
                      }
                    }
                  },
                  "required": [
                    "commands"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/apns": {
      "get": {
        "summary": "Get APNs certificate info",
        "description": "Returns Apple Push Notification service (APNs) certificate information.",
        "tags": [
          "Integrations"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "APNs info retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "common_name": {
                      "type": "string"
                    },
                    "serial_number": {
                      "type": "string"
                    },
                    "not_valid_before": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "not_valid_after": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "renew_date": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "common_name",
                    "serial_number",
                    "not_valid_before",
                    "not_valid_after",
                    "renew_date"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/abm_tokens": {
      "get": {
        "summary": "Get ABM tokens",
        "description": "Returns Apple Business Manager (ABM) token information.",
        "tags": [
          "Integrations"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "ABM tokens retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "abm_tokens": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer"
                          },
                          "apple_id": {
                            "type": "string"
                          },
                          "org_name": {
                            "type": "string"
                          },
                          "mdm_server_token": {
                            "type": "string"
                          },
                          "renew_at": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "terms_expired": {
                            "type": "boolean"
                          },
                          "teams": {
                            "type": "array",
                            "items": {}
                          }
                        },
                        "required": [
                          "id",
                          "apple_id",
                          "org_name",
                          "mdm_server_token",
                          "renew_at",
                          "terms_expired"
                        ]
                      }
                    }
                  },
                  "required": [
                    "abm_tokens"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/vpp_tokens": {
      "get": {
        "summary": "Get VPP tokens",
        "description": "Returns Volume Purchase Program (VPP) token information.",
        "tags": [
          "Integrations"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "VPP tokens retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "vpp_tokens": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer"
                          },
                          "org_name": {
                            "type": "string"
                          },
                          "location": {
                            "type": "string"
                          },
                          "renew_at": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "teams": {
                            "type": "array",
                            "items": {}
                          }
                        },
                        "required": [
                          "id",
                          "org_name",
                          "location",
                          "renew_at"
                        ]
                      }
                    }
                  },
                  "required": [
                    "vpp_tokens"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/scim/details": {
      "get": {
        "summary": "Get SCIM details",
        "description": "Returns SCIM integration details.",
        "tags": [
          "Integrations"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "SCIM details retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "scim_url": {
                      "type": "string"
                    },
                    "scim_token_expiration": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "scim_url"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/android_enterprise": {
      "get": {
        "summary": "Get Android Enterprise info",
        "description": "Returns Android Enterprise integration information.",
        "tags": [
          "Integrations"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Android Enterprise info retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "enterprise_id": {
                      "type": "string"
                    },
                    "signup_url": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/global/policies": {
      "get": {
        "summary": "List global policies",
        "description": "Returns a list of all global policies.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved global policies",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListPoliciesResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create global policy",
        "description": "Creates a new global policy.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePolicyRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Policy created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetPolicyResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/teams/{id}/policies": {
      "get": {
        "summary": "List team policies",
        "description": "Returns a list of all policies for a team.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Include inherited global policies"
            },
            "required": false,
            "description": "Include inherited global policies",
            "name": "merge_inherited",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved team policies",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListPoliciesResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create team policy",
        "description": "Creates a new policy for a team.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePolicyRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Policy created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetPolicyResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/policies/count": {
      "get": {
        "summary": "Count global policies",
        "description": "Returns the count of global policies.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved policy count",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PolicyCountResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/team/{team_id}/policies/count": {
      "get": {
        "summary": "Count team policies",
        "description": "Returns the count of policies for a team.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved policy count",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PolicyCountResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/global/policies/{id}": {
      "get": {
        "summary": "Get global policy",
        "description": "Returns a specific global policy.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Policy ID"
            },
            "required": false,
            "description": "Policy ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved policy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetPolicyResponse"
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update global policy",
        "description": "Updates an existing global policy.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Policy ID"
            },
            "required": false,
            "description": "Policy ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePolicyRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Policy updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetPolicyResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/teams/{team_id}/policies/{policy_id}": {
      "get": {
        "summary": "Get team policy",
        "description": "Returns a specific team policy.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Policy ID"
            },
            "required": false,
            "description": "Policy ID",
            "name": "policy_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved policy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetPolicyResponse"
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update team policy",
        "description": "Updates an existing team policy.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Policy ID"
            },
            "required": false,
            "description": "Policy ID",
            "name": "policy_id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePolicyRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Policy updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetPolicyResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/global/policies/delete": {
      "post": {
        "summary": "Delete global policies",
        "description": "Deletes multiple global policies.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeletePoliciesRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Policies deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeletePoliciesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/teams/{team_id}/policies/delete": {
      "post": {
        "summary": "Delete team policies",
        "description": "Deletes multiple team policies.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeletePoliciesRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Policies deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeletePoliciesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/automations/reset": {
      "post": {
        "summary": "Reset policy automations",
        "description": "Resets policy automation status for webhook/integration notifications.",
        "tags": [
          "Policies"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResetAutomationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Automations reset successfully"
          }
        }
      }
    },
    "/api/v1/fleet/queries": {
      "get": {
        "summary": "List queries",
        "description": "Returns a list of all saved queries.",
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved queries",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "queries": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer"
                          },
                          "name": {
                            "type": "string"
                          },
                          "description": {
                            "type": "string"
                          },
                          "query": {
                            "type": "string"
                          },
                          "team_id": {
                            "type": [
                              "integer",
                              "null"
                            ]
                          },
                          "interval": {
                            "type": "integer"
                          },
                          "platform": {
                            "type": "string"
                          },
                          "min_osquery_version": {
                            "type": "string"
                          },
                          "automations_enabled": {
                            "type": "boolean"
                          },
                          "logging": {
                            "type": "string"
                          },
                          "author_id": {
                            "type": "integer"
                          },
                          "author_name": {
                            "type": "string"
                          },
                          "author_email": {
                            "type": "string"
                          },
                          "saved": {
                            "type": "boolean"
                          },
                          "discard_data": {
                            "type": "boolean"
                          },
                          "observer_can_run": {
                            "type": "boolean"
                          },
                          "created_at": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updated_at": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "packs": {
                            "type": "array",
                            "items": {}
                          },
                          "stats": {}
                        },
                        "required": [
                          "id",
                          "name",
                          "query",
                          "team_id",
                          "interval",
                          "automations_enabled",
                          "logging",
                          "saved",
                          "discard_data",
                          "observer_can_run",
                          "created_at",
                          "updated_at"
                        ]
                      }
                    }
                  },
                  "required": [
                    "queries"
                  ]
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create query",
        "description": "Creates a new saved query.",
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Query name"
                  },
                  "query": {
                    "type": "string",
                    "description": "SQL query"
                  },
                  "description": {
                    "type": "string",
                    "description": "Query description"
                  },
                  "team_id": {
                    "type": "integer",
                    "description": "Team ID"
                  },
                  "interval": {
                    "type": "integer",
                    "description": "Schedule interval in seconds"
                  },
                  "platform": {
                    "type": "string",
                    "description": "Target platforms"
                  },
                  "min_osquery_version": {
                    "type": "string",
                    "description": "Minimum osquery version"
                  },
                  "automations_enabled": {
                    "type": "boolean",
                    "description": "Enable automations"
                  },
                  "logging": {
                    "type": "string",
                    "enum": [
                      "snapshot",
                      "differential",
                      "differential_ignore_removals"
                    ],
                    "description": "Logging type"
                  },
                  "observer_can_run": {
                    "type": "boolean",
                    "description": "Allow observers to run"
                  },
                  "discard_data": {
                    "type": "boolean",
                    "description": "Discard query data"
                  }
                },
                "required": [
                  "name",
                  "query"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Query created successfully"
          }
        }
      }
    },
    "/api/v1/fleet/queries/{id}": {
      "get": {
        "summary": "Get query",
        "description": "Returns a specific query.",
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Query ID"
            },
            "required": false,
            "description": "Query ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved query",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "query": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer"
                        },
                        "name": {
                          "type": "string"
                        },
                        "description": {
                          "type": "string"
                        },
                        "query": {
                          "type": "string"
                        },
                        "team_id": {
                          "type": [
                            "integer",
                            "null"
                          ]
                        },
                        "interval": {
                          "type": "integer"
                        },
                        "platform": {
                          "type": "string"
                        },
                        "logging": {
                          "type": "string"
                        },
                        "created_at": {
                          "type": "string",
                          "format": "date-time"
                        },
                        "updated_at": {
                          "type": "string",
                          "format": "date-time"
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "query",
                        "team_id",
                        "interval",
                        "logging",
                        "created_at",
                        "updated_at"
                      ]
                    }
                  },
                  "required": [
                    "query"
                  ]
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update query",
        "description": "Updates an existing query.",
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Query ID"
            },
            "required": false,
            "description": "Query ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "query": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  },
                  "interval": {
                    "type": "integer"
                  },
                  "platform": {
                    "type": "string"
                  },
                  "min_osquery_version": {
                    "type": "string"
                  },
                  "automations_enabled": {
                    "type": "boolean"
                  },
                  "logging": {
                    "type": "string"
                  },
                  "observer_can_run": {
                    "type": "boolean"
                  },
                  "discard_data": {
                    "type": "boolean"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Query updated successfully"
          }
        }
      }
    },
    "/api/v1/fleet/queries/{id}/report": {
      "get": {
        "summary": "Get query report",
        "description": "Returns the results report for a query.",
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Query ID"
            },
            "required": false,
            "description": "Query ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved query report",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "query_id": {
                      "type": "integer"
                    },
                    "results": {
                      "type": "array",
                      "items": {}
                    },
                    "report_clipped": {
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "query_id",
                    "results",
                    "report_clipped"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/queries/{query_id}": {
      "get": {
        "summary": "Get host query results",
        "description": "Returns the results of a specific query for a specific host.",
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Query ID"
            },
            "required": false,
            "description": "Query ID",
            "name": "query_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved host query results"
          }
        }
      }
    },
    "/api/v1/fleet/queries/{name}": {
      "delete": {
        "summary": "Delete query by name",
        "description": "Deletes a query by its name.",
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Query name"
            },
            "required": true,
            "description": "Query name",
            "name": "name",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Query deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/queries/id/{id}": {
      "delete": {
        "summary": "Delete query by ID",
        "description": "Deletes a query by its ID.",
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Query ID"
            },
            "required": false,
            "description": "Query ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Query deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/queries/delete": {
      "post": {
        "summary": "Delete multiple queries",
        "description": "Deletes multiple queries by ID.",
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "ids": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    },
                    "description": "Query IDs to delete"
                  }
                },
                "required": [
                  "ids"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Queries deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/queries/{id}/run": {
      "post": {
        "summary": "Run live query",
        "description": "Runs a live query on specified hosts.",
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Query ID"
            },
            "required": false,
            "description": "Query ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "host_ids": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    },
                    "description": "Host IDs to target"
                  },
                  "label_ids": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    },
                    "description": "Label IDs to target"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Query results",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "campaign_id": {
                      "type": "integer"
                    },
                    "targeted_host_count": {
                      "type": "integer"
                    },
                    "rows": {
                      "type": "array",
                      "items": {}
                    }
                  },
                  "required": [
                    "campaign_id",
                    "targeted_host_count",
                    "rows"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/scripts/run": {
      "post": {
        "summary": "Run script on host",
        "description": "Runs a script on a specific host.",
        "tags": [
          "Scripts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "host_id": {
                    "type": "integer",
                    "description": "Host ID"
                  },
                  "script_id": {
                    "type": "integer",
                    "description": "Script ID (saved script)"
                  },
                  "script_contents": {
                    "type": "string",
                    "description": "Script contents (ad-hoc script)"
                  }
                },
                "required": [
                  "host_id"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Script execution started",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "host_id": {
                      "type": "integer"
                    },
                    "execution_id": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "host_id",
                    "execution_id"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/scripts/results/{execution_id}": {
      "get": {
        "summary": "Get script results",
        "description": "Returns the results of a script execution.",
        "tags": [
          "Scripts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Script execution ID"
            },
            "required": true,
            "description": "Script execution ID",
            "name": "execution_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Script results retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "host_id": {
                      "type": "integer"
                    },
                    "execution_id": {
                      "type": "string"
                    },
                    "script_id": {
                      "type": "integer"
                    },
                    "script_contents": {
                      "type": "string"
                    },
                    "exit_code": {
                      "type": [
                        "integer",
                        "null"
                      ]
                    },
                    "output": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    },
                    "runtime": {
                      "type": "integer"
                    },
                    "host_timeout": {
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "host_id",
                    "execution_id",
                    "script_contents",
                    "exit_code",
                    "output",
                    "message",
                    "runtime",
                    "host_timeout"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/scripts/run/batch": {
      "post": {
        "summary": "Run script on multiple hosts",
        "description": "Runs a script on multiple hosts.",
        "tags": [
          "Scripts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "script_id": {
                    "type": "integer",
                    "description": "Script ID"
                  },
                  "host_ids": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    },
                    "description": "Host IDs to target"
                  },
                  "label_ids": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    },
                    "description": "Label IDs to target"
                  },
                  "team_id": {
                    "type": "integer",
                    "description": "Team ID to target"
                  }
                },
                "required": [
                  "script_id"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Batch script execution started",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "batch_execution_id": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "batch_execution_id"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/scripts/batch": {
      "get": {
        "summary": "List batch script executions",
        "description": "Returns a list of batch script executions.",
        "tags": [
          "Scripts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Batch executions list retrieved"
          }
        }
      }
    },
    "/api/v1/fleet/scripts/batch/{batch_execution_id}": {
      "get": {
        "summary": "Get batch script execution",
        "description": "Returns details about a batch script execution.",
        "tags": [
          "Scripts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Batch execution ID"
            },
            "required": true,
            "description": "Batch execution ID",
            "name": "batch_execution_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Batch execution details retrieved"
          }
        }
      }
    },
    "/api/v1/fleet/scripts/batch/{batch_execution_id}/host-results": {
      "get": {
        "summary": "Get batch script host results",
        "description": "Returns host-level results for a batch script execution.",
        "tags": [
          "Scripts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Batch execution ID"
            },
            "required": true,
            "description": "Batch execution ID",
            "name": "batch_execution_id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "ran",
                "pending",
                "error"
              ],
              "description": "Status filter"
            },
            "required": false,
            "description": "Status filter",
            "name": "status",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Host results retrieved"
          }
        }
      }
    },
    "/api/v1/fleet/scripts": {
      "post": {
        "summary": "Upload script",
        "description": "Uploads a new saved script.",
        "tags": [
          "Scripts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "script": {
                    "description": "Script file"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Script uploaded successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "script_id": {
                      "type": "integer"
                    }
                  },
                  "required": [
                    "script_id"
                  ]
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "List scripts",
        "description": "Returns a list of saved scripts.",
        "tags": [
          "Scripts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Scripts list retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "scripts": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer"
                          },
                          "team_id": {
                            "type": [
                              "integer",
                              "null"
                            ]
                          },
                          "name": {
                            "type": "string"
                          },
                          "created_at": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updated_at": {
                            "type": "string",
                            "format": "date-time"
                          }
                        },
                        "required": [
                          "id",
                          "team_id",
                          "name",
                          "created_at",
                          "updated_at"
                        ]
                      }
                    }
                  },
                  "required": [
                    "scripts"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/scripts/{id}": {
      "patch": {
        "summary": "Update script",
        "description": "Updates an existing script.",
        "tags": [
          "Scripts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Script ID"
            },
            "required": false,
            "description": "Script ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "script": {
                    "description": "Script file"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Script updated successfully"
          }
        }
      },
      "delete": {
        "summary": "Delete script",
        "description": "Deletes a saved script.",
        "tags": [
          "Scripts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Script ID"
            },
            "required": false,
            "description": "Script ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Script deleted successfully"
          }
        }
      },
      "get": {
        "summary": "Get script",
        "description": "Returns a script. Use ?alt=media to download the raw script content.",
        "tags": [
          "Scripts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Script ID"
            },
            "required": false,
            "description": "Script ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "media"
              ],
              "description": "Set to media to download raw script"
            },
            "required": false,
            "description": "Set to media to download raw script",
            "name": "alt",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Script retrieved"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/scripts": {
      "get": {
        "summary": "Get host script executions",
        "description": "Returns script execution history for a host.",
        "tags": [
          "Scripts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ]
            },
            "required": false,
            "name": "per_page",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Host script executions retrieved"
          }
        }
      }
    },
    "/api/v1/fleet/sessions/{id}": {
      "get": {
        "summary": "Get session",
        "description": "Returns session information.",
        "tags": [
          "Sessions"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Session ID"
            },
            "required": false,
            "description": "Session ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved session",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "session_id": {
                      "type": "integer"
                    },
                    "user_id": {
                      "type": "integer"
                    },
                    "created_at": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "session_id",
                    "user_id",
                    "created_at"
                  ]
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete session",
        "description": "Deletes (invalidates) a session.",
        "tags": [
          "Sessions"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Session ID"
            },
            "required": false,
            "description": "Session ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Session deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/software/titles": {
      "get": {
        "summary": "List software titles",
        "description": "Returns a list of software titles.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Filter to only vulnerable software"
            },
            "required": false,
            "description": "Filter to only vulnerable software",
            "name": "vulnerable",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Filter to software available for install"
            },
            "required": false,
            "description": "Filter to software available for install",
            "name": "available_for_install",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Filter to self-service software"
            },
            "required": false,
            "description": "Filter to self-service software",
            "name": "self_service",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Platform filter (comma-separated)"
            },
            "required": false,
            "description": "Platform filter (comma-separated)",
            "name": "platform",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved software titles",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "software_titles": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer"
                          },
                          "name": {
                            "type": "string"
                          },
                          "software_package": {},
                          "app_store_app": {},
                          "versions_count": {
                            "type": "integer"
                          },
                          "source": {
                            "type": "string"
                          },
                          "hosts_count": {
                            "type": "integer"
                          },
                          "versions": {
                            "type": "array",
                            "items": {}
                          },
                          "browser": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "id",
                          "name",
                          "versions_count",
                          "source",
                          "hosts_count"
                        ]
                      }
                    },
                    "count": {
                      "type": "integer"
                    },
                    "counts_updated_at": {
                      "type": [
                        "string",
                        "null"
                      ],
                      "format": "date-time"
                    },
                    "meta": {
                      "type": "object",
                      "properties": {
                        "has_next_results": {
                          "type": "boolean"
                        },
                        "has_previous_results": {
                          "type": "boolean"
                        }
                      },
                      "required": [
                        "has_next_results",
                        "has_previous_results"
                      ]
                    }
                  },
                  "required": [
                    "software_titles",
                    "count",
                    "counts_updated_at",
                    "meta"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/software/versions": {
      "get": {
        "summary": "List software versions",
        "description": "Returns a list of software versions.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Filter to only vulnerable software"
            },
            "required": false,
            "description": "Filter to only vulnerable software",
            "name": "vulnerable",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved software versions"
          }
        }
      }
    },
    "/api/v1/fleet/os_versions": {
      "get": {
        "summary": "List OS versions",
        "description": "Returns a list of operating system versions.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Platform filter"
            },
            "required": false,
            "description": "Platform filter",
            "name": "platform",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "OS name filter"
            },
            "required": false,
            "description": "OS name filter",
            "name": "os_name",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "OS version filter"
            },
            "required": false,
            "description": "OS version filter",
            "name": "os_version",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved OS versions"
          }
        }
      }
    },
    "/api/v1/fleet/software/titles/{id}": {
      "get": {
        "summary": "Get software title",
        "description": "Returns a specific software title.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID"
            },
            "required": false,
            "description": "Software title ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved software title"
          }
        }
      }
    },
    "/api/v1/fleet/software/versions/{id}": {
      "get": {
        "summary": "Get software version",
        "description": "Returns a specific software version.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software version ID"
            },
            "required": false,
            "description": "Software version ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved software version"
          }
        }
      }
    },
    "/api/v1/fleet/os_versions/{id}": {
      "get": {
        "summary": "Get OS version",
        "description": "Returns a specific OS version.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "OS version ID"
            },
            "required": false,
            "description": "OS version ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved OS version"
          }
        }
      }
    },
    "/api/v1/fleet/software/package": {
      "post": {
        "summary": "Upload software package",
        "description": "Uploads a software package to Fleet.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "software": {
                    "description": "Software package file"
                  },
                  "install_script": {
                    "type": "string",
                    "description": "Install script"
                  },
                  "pre_install_query": {
                    "type": "string",
                    "description": "Pre-install query"
                  },
                  "post_install_script": {
                    "type": "string",
                    "description": "Post-install script"
                  },
                  "uninstall_script": {
                    "type": "string",
                    "description": "Uninstall script"
                  },
                  "self_service": {
                    "type": [
                      "boolean",
                      "null"
                    ],
                    "description": "Enable self-service"
                  },
                  "labels_include_any": {
                    "type": "string",
                    "description": "Labels to include (comma-separated)"
                  },
                  "labels_exclude_any": {
                    "type": "string",
                    "description": "Labels to exclude (comma-separated)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Software package uploaded successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "software_title_id": {
                      "type": "integer"
                    }
                  },
                  "required": [
                    "software_title_id"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/software/titles/{id}/package": {
      "patch": {
        "summary": "Update software package",
        "description": "Updates an existing software package.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID"
            },
            "required": false,
            "description": "Software title ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "software": {
                    "description": "Software package file"
                  },
                  "install_script": {
                    "type": "string",
                    "description": "Install script"
                  },
                  "pre_install_query": {
                    "type": "string",
                    "description": "Pre-install query"
                  },
                  "post_install_script": {
                    "type": "string",
                    "description": "Post-install script"
                  },
                  "uninstall_script": {
                    "type": "string",
                    "description": "Uninstall script"
                  },
                  "self_service": {
                    "type": [
                      "boolean",
                      "null"
                    ],
                    "description": "Enable self-service"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Software package updated successfully"
          }
        }
      },
      "get": {
        "summary": "Download software package",
        "description": "Downloads the software package. Use ?alt=media to get the binary.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID"
            },
            "required": false,
            "description": "Software title ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "media"
              ],
              "description": "Set to media to download the package"
            },
            "required": false,
            "description": "Set to media to download the package",
            "name": "alt",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Package downloaded"
          }
        }
      }
    },
    "/api/v1/fleet/software/titles/{id}/icon": {
      "put": {
        "summary": "Upload software icon",
        "description": "Uploads an icon for a software title.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID"
            },
            "required": false,
            "description": "Software title ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "icon": {
                    "description": "Icon image file"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Icon uploaded successfully"
          }
        }
      },
      "get": {
        "summary": "Get software icon",
        "description": "Returns the icon for a software title.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID"
            },
            "required": false,
            "description": "Software title ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Icon retrieved",
            "content": {
              "image/png": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete software icon",
        "description": "Deletes the icon for a software title.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID"
            },
            "required": false,
            "description": "Software title ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Icon deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/software/app_store_apps": {
      "get": {
        "summary": "List App Store apps",
        "description": "Returns a list of available App Store apps.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved App Store apps"
          }
        }
      },
      "post": {
        "summary": "Add App Store app",
        "description": "Adds an App Store app for deployment.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "app_store_id": {
                    "type": "string",
                    "description": "App Store app ID"
                  },
                  "team_id": {
                    "type": "integer",
                    "description": "Team ID"
                  },
                  "self_service": {
                    "type": "boolean",
                    "description": "Enable self-service"
                  }
                },
                "required": [
                  "app_store_id",
                  "team_id"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "App Store app added successfully"
          }
        }
      }
    },
    "/api/v1/fleet/software/titles/{title_id}/app_store_app": {
      "patch": {
        "summary": "Update App Store app",
        "description": "Updates an App Store app configuration.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID"
            },
            "required": false,
            "description": "Software title ID",
            "name": "title_id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "self_service": {
                    "type": "boolean",
                    "description": "Enable self-service"
                  },
                  "labels_include_any": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "labels_exclude_any": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "App Store app updated successfully"
          }
        }
      }
    },
    "/api/v1/fleet/software/fleet_maintained_apps": {
      "get": {
        "summary": "List Fleet-maintained apps",
        "description": "Returns a list of available Fleet-maintained apps.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved Fleet-maintained apps"
          }
        }
      },
      "post": {
        "summary": "Create Fleet-maintained app",
        "description": "Add Fleet-maintained app so it's available for install.\n\n**Experimental feature.** This feature is undergoing rapid improvement, which may result in breaking changes to the API or configuration surface. It is not recommended for use in automated workflows.\n\n_Available in Fleet Premium._\n\nOnly one of `labels_include_any` or `labels_exclude_any` can be specified. If neither are specified, all hosts are targeted.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateFleetMaintainedAppRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully created Fleet-maintained app",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateFleetMaintainedAppResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token"
          },
          "402": {
            "description": "Payment required - Fleet Premium license required"
          }
        }
      }
    },
    "/api/v1/fleet/software/fleet_maintained_apps/{id}": {
      "get": {
        "summary": "Get Fleet-maintained app",
        "description": "Returns details about a specific Fleet-maintained app.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Fleet-maintained app ID"
            },
            "required": false,
            "description": "Fleet-maintained app ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved Fleet-maintained app"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/software/{software_title_id}/install": {
      "post": {
        "summary": "Install software on host",
        "description": "Triggers software installation on a specific host.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID"
            },
            "required": false,
            "description": "Software title ID",
            "name": "software_title_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Installation triggered"
          }
        }
      }
    },
    "/api/v1/fleet/hosts/{id}/software/{software_title_id}/uninstall": {
      "post": {
        "summary": "Uninstall software from host",
        "description": "Triggers software uninstallation on a specific host.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Host ID"
            },
            "required": false,
            "description": "Host ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID"
            },
            "required": false,
            "description": "Software title ID",
            "name": "software_title_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Uninstallation triggered"
          }
        }
      }
    },
    "/api/v1/fleet/software/install/{install_uuid}/results": {
      "get": {
        "summary": "Get software install results",
        "description": "Returns the results of a software installation.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Install UUID"
            },
            "required": true,
            "description": "Install UUID",
            "name": "install_uuid",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Install results retrieved"
          }
        }
      }
    },
    "/api/v1/fleet/software/titles/{software_title_id}/available_for_install": {
      "delete": {
        "summary": "Remove software from install list",
        "description": "Removes a software title from the available for install list.",
        "tags": [
          "Software"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Software title ID"
            },
            "required": false,
            "description": "Software title ID",
            "name": "software_title_id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Software removed from install list"
          }
        }
      }
    },
    "/api/v1/fleet/vulnerabilities": {
      "get": {
        "summary": "List vulnerabilities",
        "description": "Returns a list of vulnerabilities.",
        "tags": [
          "Vulnerabilities"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Filter to known exploits"
            },
            "required": false,
            "description": "Filter to known exploits",
            "name": "exploit",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved vulnerabilities",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "vulnerabilities": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "cve": {
                            "type": "string"
                          },
                          "hosts_count": {
                            "type": "integer"
                          },
                          "hosts_count_updated_at": {
                            "type": [
                              "string",
                              "null"
                            ],
                            "format": "date-time"
                          },
                          "details_link": {
                            "type": "string"
                          },
                          "cvss_score": {
                            "type": [
                              "number",
                              "null"
                            ]
                          },
                          "epss_probability": {
                            "type": [
                              "number",
                              "null"
                            ]
                          },
                          "cisa_known_exploit": {
                            "type": "boolean"
                          },
                          "cve_published": {
                            "type": [
                              "string",
                              "null"
                            ],
                            "format": "date-time"
                          },
                          "cve_description": {
                            "type": [
                              "string",
                              "null"
                            ]
                          },
                          "resolved_in_version": {
                            "type": [
                              "string",
                              "null"
                            ]
                          }
                        },
                        "required": [
                          "cve",
                          "hosts_count",
                          "hosts_count_updated_at",
                          "details_link",
                          "cvss_score",
                          "epss_probability",
                          "cisa_known_exploit",
                          "cve_published",
                          "cve_description",
                          "resolved_in_version"
                        ]
                      }
                    },
                    "count": {
                      "type": "integer"
                    },
                    "counts_updated_at": {
                      "type": [
                        "string",
                        "null"
                      ],
                      "format": "date-time"
                    },
                    "meta": {
                      "type": "object",
                      "properties": {
                        "has_next_results": {
                          "type": "boolean"
                        },
                        "has_previous_results": {
                          "type": "boolean"
                        }
                      },
                      "required": [
                        "has_next_results",
                        "has_previous_results"
                      ]
                    }
                  },
                  "required": [
                    "vulnerabilities",
                    "count",
                    "counts_updated_at",
                    "meta"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/vulnerabilities/{cve}": {
      "get": {
        "summary": "Get vulnerability",
        "description": "Returns details about a specific vulnerability.",
        "tags": [
          "Vulnerabilities"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "CVE identifier"
            },
            "required": true,
            "description": "CVE identifier",
            "name": "cve",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved vulnerability",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "vulnerability": {
                      "type": "object",
                      "properties": {
                        "cve": {
                          "type": "string"
                        },
                        "hosts_count": {
                          "type": "integer"
                        },
                        "hosts_count_updated_at": {
                          "type": [
                            "string",
                            "null"
                          ],
                          "format": "date-time"
                        },
                        "details_link": {
                          "type": "string"
                        },
                        "cvss_score": {
                          "type": [
                            "number",
                            "null"
                          ]
                        },
                        "epss_probability": {
                          "type": [
                            "number",
                            "null"
                          ]
                        },
                        "cisa_known_exploit": {
                          "type": "boolean"
                        },
                        "cve_published": {
                          "type": [
                            "string",
                            "null"
                          ],
                          "format": "date-time"
                        },
                        "cve_description": {
                          "type": [
                            "string",
                            "null"
                          ]
                        },
                        "software": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "integer"
                              },
                              "name": {
                                "type": "string"
                              },
                              "version": {
                                "type": "string"
                              },
                              "source": {
                                "type": "string"
                              },
                              "hosts_count": {
                                "type": "integer"
                              },
                              "resolved_in_version": {
                                "type": [
                                  "string",
                                  "null"
                                ]
                              }
                            },
                            "required": [
                              "id",
                              "name",
                              "version",
                              "source",
                              "hosts_count",
                              "resolved_in_version"
                            ]
                          }
                        },
                        "os_versions": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "os_version_id": {
                                "type": "integer"
                              },
                              "hosts_count": {
                                "type": "integer"
                              },
                              "name": {
                                "type": "string"
                              },
                              "name_only": {
                                "type": "string"
                              },
                              "version": {
                                "type": "string"
                              },
                              "platform": {
                                "type": "string"
                              },
                              "resolved_in_version": {
                                "type": [
                                  "string",
                                  "null"
                                ]
                              }
                            },
                            "required": [
                              "os_version_id",
                              "hosts_count",
                              "name",
                              "name_only",
                              "version",
                              "platform",
                              "resolved_in_version"
                            ]
                          }
                        }
                      },
                      "required": [
                        "cve",
                        "hosts_count",
                        "hosts_count_updated_at",
                        "details_link",
                        "cvss_score",
                        "epss_probability",
                        "cisa_known_exploit",
                        "cve_published",
                        "cve_description",
                        "software",
                        "os_versions"
                      ]
                    }
                  },
                  "required": [
                    "vulnerability"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/targets": {
      "post": {
        "summary": "Search targets",
        "description": "Retrieves the count of targets for a query based on the hosts, labels, and teams.",
        "tags": [
          "Targets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "SQL query (for validation)"
                  },
                  "query_id": {
                    "type": "integer",
                    "description": "Query ID to use"
                  },
                  "selected": {
                    "type": "object",
                    "properties": {
                      "hosts": {
                        "type": "array",
                        "items": {
                          "type": "integer"
                        },
                        "description": "Selected host IDs"
                      },
                      "labels": {
                        "type": "array",
                        "items": {
                          "type": "integer"
                        },
                        "description": "Selected label IDs"
                      },
                      "teams": {
                        "type": "array",
                        "items": {
                          "type": "integer"
                        },
                        "description": "Selected team IDs"
                      }
                    },
                    "description": "Selected targets"
                  }
                },
                "required": [
                  "selected"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully retrieved targets",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "targets": {
                      "type": "object",
                      "properties": {
                        "hosts": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "integer"
                              },
                              "display_text": {
                                "type": "string"
                              },
                              "label": {
                                "type": "string"
                              },
                              "status": {
                                "type": "string"
                              },
                              "seen_time": {
                                "type": "string",
                                "format": "date-time"
                              },
                              "platform": {
                                "type": "string"
                              }
                            },
                            "required": [
                              "id",
                              "display_text",
                              "label",
                              "status",
                              "seen_time",
                              "platform"
                            ]
                          }
                        },
                        "labels": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "integer"
                              },
                              "name": {
                                "type": "string"
                              },
                              "description": {
                                "type": "string"
                              },
                              "label_type": {
                                "type": "string"
                              },
                              "count": {
                                "type": "integer"
                              }
                            },
                            "required": [
                              "id",
                              "name",
                              "description",
                              "label_type",
                              "count"
                            ]
                          }
                        },
                        "teams": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "integer"
                              },
                              "name": {
                                "type": "string"
                              },
                              "count": {
                                "type": "integer"
                              }
                            },
                            "required": [
                              "id",
                              "name",
                              "count"
                            ]
                          }
                        }
                      },
                      "required": [
                        "hosts",
                        "labels",
                        "teams"
                      ]
                    },
                    "targets_count": {
                      "type": "integer"
                    },
                    "targets_online": {
                      "type": "integer"
                    },
                    "targets_offline": {
                      "type": "integer"
                    },
                    "targets_missing_in_action": {
                      "type": "integer"
                    }
                  },
                  "required": [
                    "targets",
                    "targets_count",
                    "targets_online",
                    "targets_offline",
                    "targets_missing_in_action"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/teams": {
      "get": {
        "summary": "List teams",
        "description": "Returns a list of all teams.",
        "tags": [
          "Teams"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved teams",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "teams": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer"
                          },
                          "created_at": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "description": {
                            "type": "string"
                          },
                          "agent_options": {},
                          "user_count": {
                            "type": "integer"
                          },
                          "host_count": {
                            "type": "integer"
                          },
                          "secrets": {
                            "type": "array",
                            "items": {}
                          }
                        },
                        "required": [
                          "id",
                          "created_at",
                          "name",
                          "user_count",
                          "host_count"
                        ]
                      }
                    }
                  },
                  "required": [
                    "teams"
                  ]
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create team",
        "description": "Creates a new team.",
        "tags": [
          "Teams"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Team name"
                  },
                  "description": {
                    "type": "string",
                    "description": "Team description"
                  },
                  "secrets": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "secret": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "secret"
                      ]
                    },
                    "description": "Enroll secrets"
                  },
                  "agent_options": {
                    "description": "Agent options"
                  }
                },
                "required": [
                  "name"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Team created successfully"
          }
        }
      }
    },
    "/api/v1/fleet/teams/{id}": {
      "get": {
        "summary": "Get team",
        "description": "Returns a specific team.",
        "tags": [
          "Teams"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved team",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "team": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer"
                        },
                        "created_at": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        },
                        "description": {
                          "type": "string"
                        },
                        "agent_options": {},
                        "user_count": {
                          "type": "integer"
                        },
                        "host_count": {
                          "type": "integer"
                        },
                        "users": {
                          "type": "array",
                          "items": {}
                        },
                        "secrets": {
                          "type": "array",
                          "items": {}
                        }
                      },
                      "required": [
                        "id",
                        "created_at",
                        "name",
                        "user_count",
                        "host_count"
                      ]
                    }
                  },
                  "required": [
                    "team"
                  ]
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update team",
        "description": "Updates an existing team.",
        "tags": [
          "Teams"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Team name"
                  },
                  "description": {
                    "type": "string",
                    "description": "Team description"
                  },
                  "webhook_settings": {
                    "description": "Webhook settings"
                  },
                  "integrations": {
                    "description": "Integration settings"
                  },
                  "mdm": {
                    "description": "MDM settings"
                  },
                  "host_expiry_settings": {
                    "description": "Host expiry settings"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Team updated successfully"
          }
        }
      },
      "delete": {
        "summary": "Delete team",
        "description": "Deletes a team.",
        "tags": [
          "Teams"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Team deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/teams/{id}/users": {
      "patch": {
        "summary": "Modify team users",
        "description": "Modifies the users assigned to a team.",
        "tags": [
          "Teams"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "users": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer",
                          "description": "User ID"
                        },
                        "role": {
                          "type": "string",
                          "description": "Role (admin, maintainer, observer, observer_plus, gitops)"
                        }
                      },
                      "required": [
                        "id",
                        "role"
                      ]
                    },
                    "description": "Users to add/modify"
                  }
                },
                "required": [
                  "users"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Team users modified successfully"
          }
        }
      }
    },
    "/api/v1/fleet/teams/{id}/agent_options": {
      "post": {
        "summary": "Apply team agent options",
        "description": "Applies agent options to a team.",
        "tags": [
          "Teams"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID"
            },
            "required": false,
            "description": "Team ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Force apply even with errors"
            },
            "required": false,
            "description": "Force apply even with errors",
            "name": "force",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "boolean",
                "null"
              ],
              "description": "Validate without applying"
            },
            "required": false,
            "description": "Validate without applying",
            "name": "dry_run",
            "in": "query"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "description": "Agent options object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Agent options applied successfully"
          }
        }
      }
    },
    "/api/v1/fleet/users": {
      "get": {
        "summary": "List users",
        "description": "Returns a list of all users.",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Team ID filter"
            },
            "required": false,
            "description": "Team ID filter",
            "name": "team_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved users",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "users": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer"
                          },
                          "name": {
                            "type": "string"
                          },
                          "email": {
                            "type": "string"
                          },
                          "enabled": {
                            "type": "boolean"
                          },
                          "force_password_reset": {
                            "type": "boolean"
                          },
                          "gravatar_url": {
                            "type": "string"
                          },
                          "sso_enabled": {
                            "type": "boolean"
                          },
                          "mfa_enabled": {
                            "type": "boolean"
                          },
                          "global_role": {
                            "type": [
                              "string",
                              "null"
                            ]
                          },
                          "teams": {
                            "type": "array",
                            "items": {}
                          },
                          "created_at": {
                            "type": "string"
                          },
                          "updated_at": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "id",
                          "name",
                          "email",
                          "enabled",
                          "force_password_reset",
                          "gravatar_url",
                          "sso_enabled",
                          "global_role",
                          "teams",
                          "created_at",
                          "updated_at"
                        ]
                      }
                    }
                  },
                  "required": [
                    "users"
                  ]
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create user (via invite)",
        "description": "Creates a new user by accepting an invite.",
        "tags": [
          "Users"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "User name"
                  },
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "User email"
                  },
                  "password": {
                    "type": "string",
                    "description": "User password"
                  },
                  "invite_token": {
                    "type": "string",
                    "description": "Invite token"
                  }
                },
                "required": [
                  "name",
                  "email",
                  "password",
                  "invite_token"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User created successfully"
          }
        }
      }
    },
    "/api/v1/fleet/users/admin": {
      "post": {
        "summary": "Create admin user",
        "description": "Creates a new user with admin privileges.",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "User name"
                  },
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "User email"
                  },
                  "password": {
                    "type": "string",
                    "description": "User password"
                  },
                  "sso_enabled": {
                    "type": "boolean",
                    "description": "Enable SSO"
                  },
                  "api_only": {
                    "type": "boolean",
                    "description": "API-only user"
                  },
                  "global_role": {
                    "type": "string",
                    "description": "Global role"
                  },
                  "teams": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer"
                        },
                        "role": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "role"
                      ]
                    },
                    "description": "Team assignments"
                  }
                },
                "required": [
                  "name",
                  "email"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User created successfully"
          }
        }
      }
    },
    "/api/v1/fleet/users/{id}": {
      "get": {
        "summary": "Get user",
        "description": "Returns a specific user.",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "User ID"
            },
            "required": false,
            "description": "User ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved user",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "user": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer"
                        },
                        "name": {
                          "type": "string"
                        },
                        "email": {
                          "type": "string"
                        },
                        "enabled": {
                          "type": "boolean"
                        },
                        "force_password_reset": {
                          "type": "boolean"
                        },
                        "gravatar_url": {
                          "type": "string"
                        },
                        "sso_enabled": {
                          "type": "boolean"
                        },
                        "mfa_enabled": {
                          "type": "boolean"
                        },
                        "global_role": {
                          "type": [
                            "string",
                            "null"
                          ]
                        },
                        "teams": {
                          "type": "array",
                          "items": {}
                        },
                        "created_at": {
                          "type": "string"
                        },
                        "updated_at": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "email",
                        "enabled",
                        "force_password_reset",
                        "gravatar_url",
                        "sso_enabled",
                        "global_role",
                        "teams",
                        "created_at",
                        "updated_at"
                      ]
                    }
                  },
                  "required": [
                    "user"
                  ]
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update user",
        "description": "Updates an existing user.",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "User ID"
            },
            "required": false,
            "description": "User ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "User name"
                  },
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "User email"
                  },
                  "password": {
                    "type": "string",
                    "description": "New password"
                  },
                  "sso_enabled": {
                    "type": "boolean",
                    "description": "Enable SSO"
                  },
                  "api_only": {
                    "type": "boolean",
                    "description": "API-only user"
                  },
                  "global_role": {
                    "type": [
                      "string",
                      "null"
                    ],
                    "description": "Global role"
                  },
                  "teams": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer"
                        },
                        "role": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "role"
                      ]
                    },
                    "description": "Team assignments"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User updated successfully"
          }
        }
      },
      "delete": {
        "summary": "Delete user",
        "description": "Deletes a user.",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "User ID"
            },
            "required": false,
            "description": "User ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "User deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/users/{id}/require_password_reset": {
      "post": {
        "summary": "Require password reset",
        "description": "Forces a user to reset their password on next login.",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "User ID"
            },
            "required": false,
            "description": "User ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "require": {
                    "type": "boolean",
                    "description": "Whether to require password reset"
                  }
                },
                "required": [
                  "require"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password reset requirement set"
          }
        }
      }
    },
    "/api/v1/fleet/users/{id}/sessions": {
      "get": {
        "summary": "Get user sessions",
        "description": "Returns all sessions for a user.",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "User ID"
            },
            "required": false,
            "description": "User ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved sessions",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "sessions": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "session_id": {
                            "type": "integer"
                          },
                          "user_id": {
                            "type": "integer"
                          },
                          "created_at": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "session_id",
                          "user_id",
                          "created_at"
                        ]
                      }
                    }
                  },
                  "required": [
                    "sessions"
                  ]
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete user sessions",
        "description": "Deletes all sessions for a user.",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "User ID"
            },
            "required": false,
            "description": "User ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Sessions deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/invites": {
      "post": {
        "summary": "Create invite",
        "description": "Creates a new invite for a user.",
        "tags": [
          "Invites"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Invited user name"
                  },
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "Invited user email"
                  },
                  "global_role": {
                    "type": [
                      "string",
                      "null"
                    ],
                    "description": "Global role"
                  },
                  "teams": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer",
                          "description": "Team ID"
                        },
                        "role": {
                          "type": "string",
                          "description": "Role in the team"
                        }
                      },
                      "required": [
                        "id",
                        "role"
                      ]
                    },
                    "description": "Team assignments"
                  }
                },
                "required": [
                  "name",
                  "email"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Invite created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "invite": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer"
                        },
                        "name": {
                          "type": "string"
                        },
                        "email": {
                          "type": "string"
                        },
                        "created_at": {
                          "type": "string"
                        },
                        "token": {
                          "type": "string"
                        },
                        "global_role": {
                          "type": [
                            "string",
                            "null"
                          ]
                        },
                        "teams": {
                          "type": "array",
                          "items": {}
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "email",
                        "created_at",
                        "token",
                        "global_role",
                        "teams"
                      ]
                    }
                  },
                  "required": [
                    "invite"
                  ]
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "List invites",
        "description": "Returns a list of all pending invites.",
        "tags": [
          "Invites"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Page number"
            },
            "required": false,
            "description": "Page number",
            "name": "page",
            "in": "query"
          },
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Results per page"
            },
            "required": false,
            "description": "Results per page",
            "name": "per_page",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Column to order by"
            },
            "required": false,
            "description": "Column to order by",
            "name": "order_key",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "description": "Order direction"
            },
            "required": false,
            "description": "Order direction",
            "name": "order_direction",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Search query"
            },
            "required": false,
            "description": "Search query",
            "name": "query",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved invites",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "invites": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer"
                          },
                          "name": {
                            "type": "string"
                          },
                          "email": {
                            "type": "string"
                          },
                          "created_at": {
                            "type": "string"
                          },
                          "global_role": {
                            "type": [
                              "string",
                              "null"
                            ]
                          },
                          "teams": {
                            "type": "array",
                            "items": {}
                          }
                        },
                        "required": [
                          "id",
                          "name",
                          "email",
                          "created_at",
                          "global_role",
                          "teams"
                        ]
                      }
                    }
                  },
                  "required": [
                    "invites"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/invites/{id}": {
      "delete": {
        "summary": "Delete invite",
        "description": "Deletes a pending invite.",
        "tags": [
          "Invites"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Invite ID"
            },
            "required": false,
            "description": "Invite ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Invite deleted successfully"
          }
        }
      },
      "patch": {
        "summary": "Update invite",
        "description": "Updates a pending invite.",
        "tags": [
          "Invites"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Invite ID"
            },
            "required": false,
            "description": "Invite ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Invited user name"
                  },
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "Invited user email"
                  },
                  "global_role": {
                    "type": [
                      "string",
                      "null"
                    ],
                    "description": "Global role"
                  },
                  "teams": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer"
                        },
                        "role": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "role"
                      ]
                    },
                    "description": "Team assignments"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Invite updated successfully"
          }
        }
      }
    },
    "/api/v1/fleet/invites/{token}": {
      "get": {
        "summary": "Verify invite",
        "description": "Verifies an invite token and returns invite information.",
        "tags": [
          "Invites"
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Invite token"
            },
            "required": true,
            "description": "Invite token",
            "name": "token",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Invite verified",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "invite": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer"
                        },
                        "name": {
                          "type": "string"
                        },
                        "email": {
                          "type": "string"
                        },
                        "created_at": {
                          "type": "string"
                        },
                        "global_role": {
                          "type": [
                            "string",
                            "null"
                          ]
                        },
                        "teams": {
                          "type": "array",
                          "items": {}
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "email",
                        "created_at",
                        "global_role",
                        "teams"
                      ]
                    }
                  },
                  "required": [
                    "invite"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/custom_variables": {
      "get": {
        "summary": "List custom variables",
        "description": "Returns a list of all custom variables.",
        "tags": [
          "Custom Variables"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved custom variables",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "custom_variables": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer"
                          },
                          "name": {
                            "type": "string"
                          },
                          "value": {
                            "type": "string"
                          },
                          "created_at": {
                            "type": "string"
                          },
                          "updated_at": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "id",
                          "name",
                          "value",
                          "created_at",
                          "updated_at"
                        ]
                      }
                    }
                  },
                  "required": [
                    "custom_variables"
                  ]
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create custom variable",
        "description": "Creates a new custom variable.",
        "tags": [
          "Custom Variables"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Variable name"
                  },
                  "value": {
                    "type": "string",
                    "description": "Variable value"
                  }
                },
                "required": [
                  "name",
                  "value"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Custom variable created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "custom_variable": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer"
                        },
                        "name": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        },
                        "created_at": {
                          "type": "string"
                        },
                        "updated_at": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "value",
                        "created_at",
                        "updated_at"
                      ]
                    }
                  },
                  "required": [
                    "custom_variable"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/fleet/custom_variables/{id}": {
      "delete": {
        "summary": "Delete custom variable",
        "description": "Deletes a custom variable.",
        "tags": [
          "Custom Variables"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Custom variable ID"
            },
            "required": false,
            "description": "Custom variable ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Custom variable deleted successfully"
          }
        }
      }
    },
    "/api/v1/fleet/translate": {
      "post": {
        "summary": "Translate identifiers",
        "description": "Translates identifiers between different formats (e.g., host name to host ID).",
        "tags": [
          "Translator"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "list": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "Payload type (e.g., host)"
                        },
                        "payload": {
                          "type": "object",
                          "properties": {
                            "identifier": {
                              "type": "string",
                              "description": "Identifier to translate"
                            }
                          },
                          "required": [
                            "identifier"
                          ]
                        }
                      },
                      "required": [
                        "type",
                        "payload"
                      ]
                    },
                    "description": "List of items to translate"
                  }
                },
                "required": [
                  "list"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Translation successful",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "list": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "type": {
                            "type": "string"
                          },
                          "payload": {
                            "type": "object",
                            "properties": {
                              "identifier": {
                                "type": "string"
                              },
                              "id": {
                                "type": "integer"
                              }
                            },
                            "required": [
                              "identifier",
                              "id"
                            ]
                          }
                        },
                        "required": [
                          "type",
                          "payload"
                        ]
                      }
                    }
                  },
                  "required": [
                    "list"
                  ]
                }
              }
            }
          }
        }
      }
    }
  },
  "webhooks": {}
}